window.onload=function(){function e(){for(var e=0;e<25;e++)for(var t=0;t<20;t++){grassType=Crafty.math.randomInt(1,4);Crafty.e("2D, Canvas, grass"+grassType).attr({x:e*16,y:t*16});e>0&&e<24&&t>0&&t<19&&Crafty.math.randomInt(0,50)>49&&Crafty.e("2D, DOM, flower, solid, SpriteAnimation").attr({x:e*16,y:t*16}).animate("wind",0,1,3).animate("wind",80,-1)}for(var e=0;e<25;e++){Crafty.e("2D, Canvas, wall_top, solid, bush"+Crafty.math.randomInt(1,2)).attr({x:e*16,y:0,z:2});Crafty.e("2D, DOM, wall_bottom, solid, bush"+Crafty.math.randomInt(1,2)).attr({x:e*16,y:304,z:2})}for(var e=1;e<19;e++){Crafty.e("2D, DOM, wall_left, solid, bush"+Crafty.math.randomInt(1,2)).attr({x:0,y:e*16,z:2});Crafty.e("2D, Canvas, wall_right, solid, bush"+Crafty.math.randomInt(1,2)).attr({x:384,y:e*16,z:2})}}Crafty.init(400,320);Crafty.canvas.init();Crafty.sprite(16,"images/sprite.png",{grass1:[0,0],grass2:[1,0],grass3:[2,0],grass4:[3,0],flower:[0,1],bush1:[0,2],bush2:[1,2],player:[0,3]});Crafty.scene("loading",function(){Crafty.load(["images/sprite.png"],function(){Crafty.scene("main")});Crafty.background("#000");Crafty.e("2D, DOM, Text").attr({w:100,h:20,x:150,y:120}).text("Loading").css({"text-align":"center"})});Crafty.scene("loading");Crafty.scene("main",function(){e();Crafty.c("Hero",{init:function(){this.requires("SpriteAnimation, Collision").animate("walk_left",6,3,8).animate("walk_right",9,3,11).animate("walk_up",3,3,5).animate("walk_down",0,3,2).bind("NewDirection",function(e){e.x<0&&(this.isPlaying("walk_left")||this.stop().animate("walk_left",10,-1));e.x>0&&(this.isPlaying("walk_right")||this.stop().animate("walk_right",10,-1));e.y<0&&(this.isPlaying("walk_up")||this.stop().animate("walk_up",10,-1));e.y>0&&(this.isPlaying("walk_down")||this.stop().animate("walk_down",10,-1));!e.x&&!e.y&&this.stop()}).bind("Moved",function(e){this.hit("solid")&&this.attr({x:e.x,y:e.y})});return this}});Crafty.c("RightControls",{init:function(){this.requires("Multiway")},rightControls:function(e){this.multiway(e,{UP_ARROW:-90,DOWN_ARROW:90,RIGHT_ARROW:0,LEFT_ARROW:180});return this}});player=Crafty.e("2D, Canvas, player, RightControls, Hero, Animate, Collision").attr({x:160,y:144,z:1}).rightControls(1)})};