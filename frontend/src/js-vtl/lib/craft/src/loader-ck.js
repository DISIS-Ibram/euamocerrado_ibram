Crafty.extend({assets:{},asset:function(e,t){if(arguments.length===1)return Crafty.assets[e];if(!Crafty.assets[e]){Crafty.assets[e]=t;this.trigger("NewAsset",{key:e,value:t})}},image_whitelist:["jpg","jpeg","gif","png","svg"],load:function(e,t,n,r){function c(){var e=this.src;this.removeEventListener&&this.removeEventListener("canplaythrough",c,!1);++f;n&&n({loaded:f,total:a,percent:f/a*100,src:e});f===a&&t&&t()}function h(){var e=this.src;r&&r({loaded:f,total:a,percent:f/a*100,src:e});f++;f===a&&t&&t()}var i=0,s=e.length,o,u,a=s,f=0,l="";for(;i<s;++i){o=e[i];l=o.substr(o.lastIndexOf(".")+1,3).toLowerCase();u=Crafty.asset(o)||null;if(Crafty.support.audio&&Crafty.audio.supported[l]){if(!u){var p=o.substr(o.lastIndexOf("/")+1).toLowerCase();u=Crafty.audio.audioElement();u.id=p;u.src=o;u.preload="auto";u.volume=Crafty.audio.volume;Crafty.asset(o,u);Crafty.audio.sounds[p]={obj:u,played:0}}u.addEventListener&&u.addEventListener("canplaythrough",c,!1)}else{if(!(Crafty.image_whitelist.indexOf(l)>=0)){a--;continue}if(!u){u=new Image;Crafty.asset(o,u)}u.onload=c;u.src=o}u.onerror=h}},modules:function(e,t,n){if(arguments.length===2&&typeof e=="object"){n=t;t=e;e="http://cdn.craftycomponents.com"}var r=function(){function g(e,t,n){for(n=0,j=e.length;n<j;++n)if(!t(e[n]))return c;return 1}function y(e,t){g(e,function(e){return!t(e)})}function b(e,t,n){function d(e){return e.call?e():s[e]}function v(){if(!--p){s[c]=1;l&&l();for(var e in u)g(e.split("|"),d)&&!y(u[e],d)&&(u[e]=[])}}e=e[h]?e:[e];var i=t&&t.call,l=i?t:n,c=i?e.join(""):t,p=e.length;setTimeout(function(){y(e,function(e){if(f[e]){c&&(o[c]=1);return f[e]==2&&v()}f[e]=1;c&&(o[c]=1);w(!r.test(e)&&a?a+e+".js":e,v)})},0);return b}function w(e,r){var i=t.createElement("script"),s=c;i.onload=i.onerror=i[m]=function(){if(i[d]&&!/^c|loade/.test(i[d])||s)return;i.onload=i[m]=null;s=1;f[e]=2;r()};i.async=1;i.src=e;n.insertBefore(i,n.firstChild)}var e=this,t=document,n=t.getElementsByTagName("head")[0],r=/^https?:\/\//,i=e.$script,s={},o={},u={},a,f={},l="string",c=!1,h="push",p="DOMContentLoaded",d="readyState",v="addEventListener",m="onreadystatechange";if(!t[d]&&t[v]){t[v](p,function E(){t.removeEventListener(p,E,c);t[d]="complete"},c);t[d]="loading"}b.get=w;b.order=function(e,t,n){(function r(i){i=e.shift();e.length?b(i,r):b(i,t,n)})()};b.path=function(e){a=e};b.ready=function(e,t,n){e=e[h]?e:[e];var r=[];!y(e,function(e){s[e]||r[h](e)})&&g(e,function(e){return s[e]})?t():!function(e){u[e]=u[e]||[];u[e][h](t);n&&n(r)}(e.join("|"));return b};b.noConflict=function(){e.$script=i;return this};return b}(),i=[],s=/^(https?|file):\/\//;for(var o in t)s.test(o)?i.push(o):i.push(e+"/"+o.toLowerCase()+"-"+t[o].toLowerCase()+".js");r(i,function(){n&&n()})}});