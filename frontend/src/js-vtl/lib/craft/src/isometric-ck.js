Crafty.extend({isometric:{_tile:{width:0,height:0},_elements:{},_pos:{x:0,y:0},_z:0,size:function(e,t){this._tile.width=e;this._tile.height=t>0?t:e/2;return this},place:function(e,t,n,r){var i=this.pos2px(e,t);i.top-=n*(this._tile.width/2);r.attr({x:i.left+Crafty.viewport._x,y:i.top+Crafty.viewport._y}).z+=n;return this},pos2px:function(e,t){return{left:e*this._tile.width+(t&1)*(this._tile.width/2),top:t*this._tile.height/2}},px2pos:function(e,t){return{x:Math.ceil(-e/this._tile.width-(t&1)*.5),y:-t/this._tile.height*2}},centerAt:function(e,t){if(typeof e=="number"&&typeof t=="number"){var n=this.pos2px(e,t);Crafty.viewport._x=-n.left+Crafty.viewport.width/2-this._tile.width/2;Crafty.viewport._y=-n.top+Crafty.viewport.height/2-this._tile.height/2;return this}return{top:-Crafty.viewport._y+Crafty.viewport.height/2-this._tile.height/2,left:-Crafty.viewport._x+Crafty.viewport.width/2-this._tile.width/2}},area:function(){var e=this.centerAt(),t=this.px2pos(-e.left+Crafty.viewport.width/2,-e.top+Crafty.viewport.height/2),n=this.px2pos(-e.left-Crafty.viewport.width/2,-e.top-Crafty.viewport.height/2);return{x:{start:t.x,end:n.x},y:{start:t.y,end:n.y}}}}});