/*******************************************************************************
*                                                                              *
* Author    :  Angus Johnson                                                   *
* Version   :  5.0.2                                                           *
* Date      :  30 December 2012                                                *
* Website   :  http://www.angusj.com                                           *
* Copyright :  Angus Johnson 2010-2012                                         *
*                                                                              *
* License:                                                                     *
* Use, modification & distribution is subject to Boost Software License Ver 1. *
* http://www.boost.org/LICENSE_1_0.txt                                         *
*                                                                              *
* Attributions:                                                                *
* The code in this library is an extension of Bala Vatti's clipping algorithm: *
* "A generic solution to polygon clipping"                                     *
* Communications of the ACM, Vol 35, Issue 7 (July 1992) pp 56-63.             *
* http://portal.acm.org/citation.cfm?id=129906                                 *
*                                                                              *
* Computer graphics and geometric modeling: implementation and algorithms      *
* By Max K. Agoston                                                            *
* Springer; 1 edition (January 4, 2005)                                        *
* http://books.google.com/books?q=vatti+clipping+agoston                       *
*                                                                              *
* See also:                                                                    *
* "Polygon Offsetting by Computing Winding Numbers"                            *
* Paper no. DETC2005-85513 pp. 565-575                                         *
* ASME 2005 International Design Engineering Technical Conferences             *
* and Computers and Information in Engineering Conference (IDETC/CIE2005)      *
* September 24â€“28, 2005 , Long Beach, California, USA                          *
* http://www.me.berkeley.edu/~mcmains/pubs/DAC05OffsetPolygon.pdf              *
*                                                                              *
*******************************************************************************//*******************************************************************************
*                                                                              *
* Author    :  Timo                                                            *
* Version   :  5.0.2.1                                                         *
* Date      :  12 January 2013                                                 *
*                                                                              *
* This is a translation of the C# Clipper library to Javascript.               *
* Int128 struct of C# is implemented using JSBN of Tom Wu.                     *
* Because Javascript lacks support for 64-bit integers, the space              *
* is a little more restricted than in C# version.                              *
*                                                                              *
* C# version has support for coordinate space:                                 *
* +-4611686018427387903 ( sqrt(2^127 -1)/2 )                                   *
* while Javascript version has support for space:                              *
* +-4503599627370495 ( sqrt(2^106 -1)/2 )                                      *
*                                                                              *
* Tom Wu's JSBN proved to be the fastest big integer library:                  *
* http://jsperf.com/big-integer-library-test                                   *
*                                                                              *
* This class can be made simpler when (if ever) 64-bit integer support comes.  *
*                                                                              *
*******************************************************************************//*******************************************************************************
*                                                                              *
* Basic JavaScript BN library - subset useful for RSA encryption.              *
* http://www-cs-students.stanford.edu/~tjw/jsbn/                               *
* Copyright (c) 2005  Tom Wu                                                   *
* All Rights Reserved.                                                         *
* See "LICENSE" for details:                                                   *
* http://www-cs-students.stanford.edu/~tjw/jsbn/LICENSE                        *
*                                                                              *
*******************************************************************************/(function(e){"use strict";function u(e,t,n){r.biginteger_used=1;if(e!=null)if("number"==typeof e)this.fromString(Math.floor(e).toString(),10);else if(t==null&&"string"!=typeof e)this.fromString(e,256);else{e.indexOf(".")!=-1&&(e=e.substring(0,e.indexOf(".")));this.fromString(e,t)}}function a(){return new u(null)}function f(e,t,n,r,i,s){while(--s>=0){var o=t*this[e++]+n[r]+i;i=Math.floor(o/67108864);n[r++]=o&67108863}return i}function l(e,t,n,r,i,s){var o=t&32767,u=t>>15;while(--s>=0){var a=this[e]&32767,f=this[e++]>>15,l=u*a+f*o;a=o*a+((l&32767)<<15)+n[r]+(i&1073741823);i=(a>>>30)+(l>>>15)+u*f+(i>>>30);n[r++]=a&1073741823}return i}function c(e,t,n,r,i,s){var o=t&16383,u=t>>14;while(--s>=0){var a=this[e]&16383,f=this[e++]>>14,l=u*a+f*o;a=o*a+((l&16383)<<14)+n[r]+i;i=(a>>28)+(l>>14)+u*f;n[r++]=a&268435455}return i}function g(e){return p.charAt(e)}function y(e,t){var n=d[e.charCodeAt(t)];return n==null?-1:n}function b(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t;e.s=this.s}function w(e){this.t=1;this.s=e<0?-1:0;e>0?this[0]=e:e<-1?this[0]=e+DV:this.t=0}function E(e){var t=a();t.fromInt(e);return t}function S(e,t){var n;if(t==16)n=4;else if(t==8)n=3;else if(t==256)n=8;else if(t==2)n=1;else if(t==32)n=5;else{if(t!=4){this.fromRadix(e,t);return}n=2}this.t=0;this.s=0;var r=e.length,i=!1,s=0;while(--r>=0){var o=n==8?e[r]&255:y(e,r);if(o<0){e.charAt(r)=="-"&&(i=!0);continue}i=!1;if(s==0)this[this.t++]=o;else if(s+n>this.DB){this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s;this[this.t++]=o>>this.DB-s}else this[this.t-1]|=o<<s;s+=n;s>=this.DB&&(s-=this.DB)}if(n==8&&(e[0]&128)!=0){this.s=-1;s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)}this.clamp();i&&u.ZERO.subTo(this,this)}function x(){var e=this.s&this.DM;while(this.t>0&&this[this.t-1]==e)--this.t}function T(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else{if(e!=4)return this.toRadix(e);t=2}var n=(1<<t)-1,r,i=!1,s="",o=this.t,u=this.DB-o*this.DB%t;if(o-->0){if(u<this.DB&&(r=this[o]>>u)>0){i=!0;s=g(r)}while(o>=0){if(u<t){r=(this[o]&(1<<u)-1)<<t-u;r|=this[--o]>>(u+=this.DB-t)}else{r=this[o]>>(u-=t)&n;if(u<=0){u+=this.DB;--o}}r>0&&(i=!0);i&&(s+=g(r))}}return i?s:"0"}function N(){var e=a();u.ZERO.subTo(this,e);return e}function C(){return this.s<0?this.negate():this}function k(e){var t=this.s-e.s;if(t!=0)return t;var n=this.t;t=n-e.t;if(t!=0)return this.s<0?-t:t;while(--n>=0)if((t=this[n]-e[n])!=0)return t;return 0}function L(e){var t=1,n;if((n=e>>>16)!=0){e=n;t+=16}if((n=e>>8)!=0){e=n;t+=8}if((n=e>>4)!=0){e=n;t+=4}if((n=e>>2)!=0){e=n;t+=2}if((n=e>>1)!=0){e=n;t+=1}return t}function A(){return this.t<=0?0:this.DB*(this.t-1)+L(this[this.t-1]^this.s&this.DM)}function O(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e;t.s=this.s}function M(e,t){for(var n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0);t.s=this.s}function _(e,t){var n=e%this.DB,r=this.DB-n,i=(1<<r)-1,s=Math.floor(e/this.DB),o=this.s<<n&this.DM,u;for(u=this.t-1;u>=0;--u){t[u+s+1]=this[u]>>r|o;o=(this[u]&i)<<n}for(u=s-1;u>=0;--u)t[u]=0;t[s]=o;t.t=this.t+s+1;t.s=this.s;t.clamp()}function D(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}var r=e%this.DB,i=this.DB-r,s=(1<<r)-1;t[0]=this[n]>>r;for(var o=n+1;o<this.t;++o){t[o-n-1]|=(this[o]&s)<<i;t[o-n]=this[o]>>r}r>0&&(t[this.t-n-1]|=(this.s&s)<<i);t.t=this.t-n;t.clamp()}function P(e,t){var n=0,r=0,i=Math.min(e.t,this.t);while(n<i){r+=this[n]-e[n];t[n++]=r&this.DM;r>>=this.DB}if(e.t<this.t){r-=e.s;while(n<this.t){r+=this[n];t[n++]=r&this.DM;r>>=this.DB}r+=this.s}else{r+=this.s;while(n<e.t){r-=e[n];t[n++]=r&this.DM;r>>=this.DB}r-=e.s}t.s=r<0?-1:0;r<-1?t[n++]=this.DV+r:r>0&&(t[n++]=r);t.t=n;t.clamp()}function H(e,t){var n=this.abs(),r=e.abs(),i=n.t;t.t=i+r.t;while(--i>=0)t[i]=0;for(i=0;i<r.t;++i)t[i+n.t]=n.am(0,r[i],t,i,0,n.t);t.s=0;t.clamp();this.s!=e.s&&u.ZERO.subTo(t,t)}function B(e){var t=this.abs(),n=e.t=2*t.t;while(--n>=0)e[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t[n],e,2*n,0,1);if((e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV){e[n+t.t]-=t.DV;e[n+t.t+1]=1}}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1));e.s=0;e.clamp()}function j(e,t,n){var r=e.abs();if(r.t<=0)return;var i=this.abs();if(i.t<r.t){t!=null&&t.fromInt(0);n!=null&&this.copyTo(n);return}n==null&&(n=a());var s=a(),o=this.s,f=e.s,l=this.DB-L(r[r.t-1]);if(l>0){r.lShiftTo(l,s);i.lShiftTo(l,n)}else{r.copyTo(s);i.copyTo(n)}var c=s.t,h=s[c-1];if(h==0)return;var p=h*(1<<this.F1)+(c>1?s[c-2]>>this.F2:0),d=this.FV/p,v=(1<<this.F1)/p,m=1<<this.F2,g=n.t,y=g-c,b=t==null?a():t;s.dlShiftTo(y,b);if(n.compareTo(b)>=0){n[n.t++]=1;n.subTo(b,n)}u.ONE.dlShiftTo(c,b);b.subTo(s,s);while(s.t<c)s[s.t++]=0;while(--y>=0){var w=n[--g]==h?this.DM:Math.floor(n[g]*d+(n[g-1]+m)*v);if((n[g]+=s.am(0,w,n,y,0,c))<w){s.dlShiftTo(y,b);n.subTo(b,n);while(n[g]<--w)n.subTo(b,n)}}if(t!=null){n.drShiftTo(c,t);o!=f&&u.ZERO.subTo(t,t)}n.t=c;n.clamp();l>0&&n.rShiftTo(l,n);o<0&&u.ZERO.subTo(n,n)}function F(e){var t=a();this.abs().divRemTo(e,null,t);this.s<0&&t.compareTo(u.ZERO)>0&&e.subTo(t,t);return t}function I(e){this.m=e}function q(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function R(e){return e}function U(e){e.divRemTo(this.m,null,e)}function z(e,t,n){e.multiplyTo(t,n);this.reduce(n)}function W(e,t){e.squareTo(t);this.reduce(t)}function X(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;t=t*(2-(e&15)*t)&15;t=t*(2-(e&255)*t)&255;t=t*(2-((e&65535)*t&65535))&65535;t=t*(2-e*t%this.DV)%this.DV;return t>0?this.DV-t:-t}function V(e){this.m=e;this.mp=e.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<e.DB-15)-1;this.mt2=2*e.t}function $(e){var t=a();e.abs().dlShiftTo(this.m.t,t);t.divRemTo(this.m,null,t);e.s<0&&t.compareTo(u.ZERO)>0&&this.m.subTo(t,t);return t}function J(e){var t=a();e.copyTo(t);this.reduce(t);return t}function K(e){while(e.t<=this.mt2)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=e[t]&32767,r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;n=t+this.m.t;e[n]+=this.m.am(0,r,e,t,0,this.m.t);while(e[n]>=e.DV){e[n]-=e.DV;e[++n]++}}e.clamp();e.drShiftTo(this.m.t,e);e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Q(e,t){e.squareTo(t);this.reduce(t)}function G(e,t,n){e.multiplyTo(t,n);this.reduce(n)}function Y(){return(this.t>0?this[0]&1:this.s)==0}function Z(e,t){if(e>4294967295||e<1)return u.ONE;var n=a(),r=a(),i=t.convert(this),s=L(e)-1;i.copyTo(n);while(--s>=0){t.sqrTo(n,r);if((e&1<<s)>0)t.mulTo(r,i,n);else{var o=n;n=r;r=o}}return t.revert(n)}function et(e,t){var n;e<256||t.isEven()?n=new I(t):n=new V(t);return this.exp(e,n)}function tt(){var e=a();this.copyTo(e);return e}function nt(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function rt(){return this.t==0?this.s:this[0]<<24>>24}function it(){return this.t==0?this.s:this[0]<<16>>16}function st(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function ot(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function ut(e){e==null&&(e=10);if(this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),n=Math.pow(e,t),r=E(n),i=a(),s=a(),o="";this.divRemTo(r,i,s);while(i.signum()>0){o=(n+s.intValue()).toString(e).substr(1)+o;i.divRemTo(r,i,s)}return s.intValue().toString(e)+o}function at(e,t){this.fromInt(0);t==null&&(t=10);var n=this.chunkSize(t),r=Math.pow(t,n),i=!1,s=0,o=0;for(var a=0;a<e.length;++a){var f=y(e,a);if(f<0){e.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=t*o+f;if(++s>=n){this.dMultiply(r);this.dAddOffset(o,0);s=0;o=0}}if(s>0){this.dMultiply(Math.pow(t,s));this.dAddOffset(o,0)}i&&u.ZERO.subTo(this,this)}function ft(e,t,n){if("number"==typeof t)if(e<2)this.fromInt(1);else{this.fromNumber(e,n);this.testBit(e-1)||this.bitwiseTo(u.ONE.shiftLeft(e-1),gt,this);this.isEven()&&this.dAddOffset(1,0);while(!this.isProbablePrime(t)){this.dAddOffset(2,0);this.bitLength()>e&&this.subTo(u.ONE.shiftLeft(e-1),this)}}else{var r=[],i=e&7;r.length=(e>>3)+1;t.nextBytes(r);i>0?r[0]&=(1<<i)-1:r[0]=0;this.fromString(r,256)}}function lt(){var e=this.t,t=[];t[0]=this.s;var n=this.DB-e*this.DB%8,r,i=0;if(e-->0){n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);while(e>=0){if(n<8){r=(this[e]&(1<<n)-1)<<8-n;r|=this[--e]>>(n+=this.DB-8)}else{r=this[e]>>(n-=8)&255;if(n<=0){n+=this.DB;--e}}(r&128)!=0&&(r|=-256);i==0&&(this.s&128)!=(r&128)&&++i;if(i>0||r!=this.s)t[i++]=r}}return t}function ct(e){return this.compareTo(e)==0}function ht(e){return this.compareTo(e)<0?this:e}function pt(e){return this.compareTo(e)>0?this:e}function dt(e,t,n){var r,i,s=Math.min(e.t,this.t);for(r=0;r<s;++r)n[r]=t(this[r],e[r]);if(e.t<this.t){i=e.s&this.DM;for(r=s;r<this.t;++r)n[r]=t(this[r],i);n.t=this.t}else{i=this.s&this.DM;for(r=s;r<e.t;++r)n[r]=t(i,e[r]);n.t=e.t}n.s=t(this.s,e.s);n.clamp()}function vt(e,t){return e&t}function mt(e){var t=a();this.bitwiseTo(e,vt,t);return t}function gt(e,t){return e|t}function yt(e){var t=a();this.bitwiseTo(e,gt,t);return t}function bt(e,t){return e^t}function wt(e){var t=a();this.bitwiseTo(e,bt,t);return t}function Et(e,t){return e&~t}function St(e){var t=a();this.bitwiseTo(e,Et,t);return t}function xt(){var e=a();for(var t=0;t<this.t;++t)e[t]=this.DM&~this[t];e.t=this.t;e.s=~this.s;return e}function Tt(e){var t=a();e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t);return t}function Nt(e){var t=a();e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t);return t}function Ct(e){if(e==0)return-1;var t=0;if((e&65535)==0){e>>=16;t+=16}if((e&255)==0){e>>=8;t+=8}if((e&15)==0){e>>=4;t+=4}if((e&3)==0){e>>=2;t+=2}(e&1)==0&&++t;return t}function kt(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+Ct(this[e]);return this.s<0?this.t*this.DB:-1}function Lt(e){var t=0;while(e!=0){e&=e-1;++t}return t}function At(){var e=0,t=this.s&this.DM;for(var n=0;n<this.t;++n)e+=Lt(this[n]^t);return e}function Ot(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this[t]&1<<e%this.DB)!=0}function Mt(e,t){var n=u.ONE.shiftLeft(e);this.bitwiseTo(n,t,n);return n}function _t(e){return this.changeBit(e,gt)}function Dt(e){return this.changeBit(e,Et)}function Pt(e){return this.changeBit(e,bt)}function Ht(e,t){var n=0,r=0,i=Math.min(e.t,this.t);while(n<i){r+=this[n]+e[n];t[n++]=r&this.DM;r>>=this.DB}if(e.t<this.t){r+=e.s;while(n<this.t){r+=this[n];t[n++]=r&this.DM;r>>=this.DB}r+=this.s}else{r+=this.s;while(n<e.t){r+=e[n];t[n++]=r&this.DM;r>>=this.DB}r+=e.s}t.s=r<0?-1:0;r>0?t[n++]=r:r<-1&&(t[n++]=this.DV+r);t.t=n;t.clamp()}function Bt(e){var t=a();this.addTo(e,t);return t}function jt(e){var t=a();this.subTo(e,t);return t}function Ft(e){var t=a();this.multiplyTo(e,t);return t}function It(){var e=a();this.squareTo(e);return e}function qt(e){var t=a();this.divRemTo(e,t,null);return t}function Rt(e){var t=a();this.divRemTo(e,null,t);return t}function Ut(e){var t=a(),n=a();this.divRemTo(e,t,n);return new Array(t,n)}function zt(e){this[this.t]=this.am(0,e-1,this,0,0,this.t);++this.t;this.clamp()}function Wt(e,t){if(e==0)return;while(this.t<=t)this[this.t++]=0;this[t]+=e;while(this[t]>=this.DV){this[t]-=this.DV;++t>=this.t&&(this[this.t++]=0);++this[t]}}function Xt(){}function Vt(e){return e}function $t(e,t,n){e.multiplyTo(t,n)}function Jt(e,t){e.squareTo(t)}function Kt(e){return this.exp(e,new Xt)}function Qt(e,t,n){var r=Math.min(this.t+e.t,t);n.s=0;n.t=r;while(r>0)n[--r]=0;var i;for(i=n.t-this.t;r<i;++r)n[r+this.t]=this.am(0,e[r],n,r,0,this.t);for(i=Math.min(e.t,t);r<i;++r)this.am(0,e[r],n,r,0,t-r);n.clamp()}function Gt(e,t,n){--t;var r=n.t=this.t+e.t-t;n.s=0;while(--r>=0)n[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)n[this.t+r-t]=this.am(t-r,e[r],n,0,0,this.t+r-t);n.clamp();n.drShiftTo(1,n)}function Yt(e){this.r2=a();this.q3=a();u.ONE.dlShiftTo(2*e.t,this.r2);this.mu=this.r2.divide(e);this.m=e}function Zt(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=a();e.copyTo(t);this.reduce(t);return t}function en(e){return e}function tn(e){e.drShiftTo(this.m.t-1,this.r2);if(e.t>this.m.t+1){e.t=this.m.t+1;e.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(e.compareTo(this.r2)<0)e.dAddOffset(1,this.m.t+1);e.subTo(this.r2,e);while(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function nn(e,t){e.squareTo(t);this.reduce(t)}function rn(e,t,n){e.multiplyTo(t,n);this.reduce(n)}function sn(e,t){var n=e.bitLength(),r,i=E(1),s;if(n<=0)return i;n<18?r=1:n<48?r=3:n<144?r=4:n<768?r=5:r=6;n<8?s=new I(t):t.isEven()?s=new Yt(t):s=new V(t);var o=[],u=3,f=r-1,l=(1<<r)-1;o[1]=s.convert(this);if(r>1){var c=a();s.sqrTo(o[1],c);while(u<=l){o[u]=a();s.mulTo(c,o[u-2],o[u]);u+=2}}var h=e.t-1,p,d=!0,v=a(),m;n=L(e[h])-1;while(h>=0){if(n>=f)p=e[h]>>n-f&l;else{p=(e[h]&(1<<n+1)-1)<<f-n;h>0&&(p|=e[h-1]>>this.DB+n-f)}u=r;while((p&1)==0){p>>=1;--u}if((n-=u)<0){n+=this.DB;--h}if(d){o[p].copyTo(i);d=!1}else{while(u>1){s.sqrTo(i,v);s.sqrTo(v,i);u-=2}if(u>0)s.sqrTo(i,v);else{m=i;i=v;v=m}s.mulTo(v,o[p],i)}while(h>=0&&(e[h]&1<<n)==0){s.sqrTo(i,v);m=i;i=v;v=m;if(--n<0){n=this.DB-1;--h}}}return s.revert(i)}function on(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var r=t;t=n;n=r}var i=t.getLowestSetBit(),s=n.getLowestSetBit();if(s<0)return t;i<s&&(s=i);if(s>0){t.rShiftTo(s,t);n.rShiftTo(s,n)}while(t.signum()>0){(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t);(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n);if(t.compareTo(n)>=0){t.subTo(n,t);t.rShiftTo(1,t)}else{n.subTo(t,n);n.rShiftTo(1,n)}}s>0&&n.lShiftTo(s,n);return n}function un(e){if(e<=0)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(t==0)n=this[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this[r])%e;return n}function an(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return u.ZERO;var n=e.clone(),r=this.clone(),i=E(1),s=E(0),o=E(0),a=E(1);while(n.signum()!=0){while(n.isEven()){n.rShiftTo(1,n);if(t){if(!i.isEven()||!s.isEven()){i.addTo(this,i);s.subTo(e,s)}i.rShiftTo(1,i)}else s.isEven()||s.subTo(e,s);s.rShiftTo(1,s)}while(r.isEven()){r.rShiftTo(1,r);if(t){if(!o.isEven()||!a.isEven()){o.addTo(this,o);a.subTo(e,a)}o.rShiftTo(1,o)}else a.isEven()||a.subTo(e,a);a.rShiftTo(1,a)}if(n.compareTo(r)>=0){n.subTo(r,n);t&&i.subTo(o,i);s.subTo(a,s)}else{r.subTo(n,r);t&&o.subTo(i,o);a.subTo(s,a)}}if(r.compareTo(u.ONE)!=0)return u.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0){a.addTo(e,a);return a.signum()<0?a.add(e):a}return a}function cn(e){var t,n=this.abs();if(n.t==1&&n[0]<=fn[fn.length-1]){for(t=0;t<fn.length;++t)if(n[0]==fn[t])return!0;return!1}if(n.isEven())return!1;t=1;while(t<fn.length){var r=fn[t],i=t+1;while(i<fn.length&&r<ln)r*=fn[i++];r=n.modInt(r);while(t<i)if(r%fn[t++]==0)return!1}return n.millerRabin(e)}function hn(e){var t=this.subtract(u.ONE),n=t.getLowestSetBit();if(n<=0)return!1;var r=t.shiftRight(n);e=e+1>>1;e>fn.length&&(e=fn.length);var i=a();for(var s=0;s<e;++s){i.fromInt(fn[Math.floor(Math.random()*fn.length)]);var o=i.modPow(r,this);if(o.compareTo(u.ONE)!=0&&o.compareTo(t)!=0){var f=1;while(f++<n&&o.compareTo(t)!=0){o=o.modPowInt(2,this);if(o.compareTo(u.ONE)==0)return!1}if(o.compareTo(t)!=0)return!1}}return!0}var t=navigator.userAgent.toString().toLowerCase(),n={};t.indexOf("chrome")!=-1&&t.indexOf("chromium")==-1?n.chrome=1:n.chrome=0;t.indexOf("chromium")!=-1?n.chromium=1:n.chromium=0;t.indexOf("safari")!=-1&&t.indexOf("chrome")==-1&&t.indexOf("chromium")==-1?n.safari=1:n.safari=0;t.indexOf("firefox")!=-1?n.firefox=1:n.firefox=0;t.indexOf("firefox/17")!=-1?n.firefox17=1:n.firefox17=0;t.indexOf("firefox/15")!=-1?n.firefox15=1:n.firefox15=0;t.indexOf("firefox/3")!=-1?n.firefox3=1:n.firefox3=0;t.indexOf("opera")!=-1?n.opera=1:n.opera=0;t.indexOf("msie 10")!=-1?n.msie10=1:n.msie10=0;t.indexOf("msie 9")!=-1?n.msie9=1:n.msie9=0;t.indexOf("msie 8")!=-1?n.msie8=1:n.msie8=0;t.indexOf("msie 7")!=-1?n.msie7=1:n.msie7=0;t.indexOf("msie ")!=-1?n.msie=1:n.msie=0;var r={};r.biginteger_used=null;var i,s=0xdeadbeefcafe,o=(s&16777215)==15715070;if(o&&navigator.appName=="Microsoft Internet Explorer"){u.prototype.am=l;i=30}else if(o&&navigator.appName!="Netscape"){u.prototype.am=f;i=26}else{u.prototype.am=c;i=28}u.prototype.DB=i;u.prototype.DM=(1<<i)-1;u.prototype.DV=1<<i;var h=52;u.prototype.FV=Math.pow(2,h);u.prototype.F1=h-i;u.prototype.F2=2*i-h;var p="0123456789abcdefghijklmnopqrstuvwxyz",d=[],v,m;v="0".charCodeAt(0);for(m=0;m<=9;++m)d[v++]=m;v="a".charCodeAt(0);for(m=10;m<36;++m)d[v++]=m;v="A".charCodeAt(0);for(m=10;m<36;++m)d[v++]=m;I.prototype.convert=q;I.prototype.revert=R;I.prototype.reduce=U;I.prototype.mulTo=z;I.prototype.sqrTo=W;V.prototype.convert=$;V.prototype.revert=J;V.prototype.reduce=K;V.prototype.mulTo=G;V.prototype.sqrTo=Q;u.prototype.copyTo=b;u.prototype.fromInt=w;u.prototype.fromString=S;u.prototype.clamp=x;u.prototype.dlShiftTo=O;u.prototype.drShiftTo=M;u.prototype.lShiftTo=_;u.prototype.rShiftTo=D;u.prototype.subTo=P;u.prototype.multiplyTo=H;u.prototype.squareTo=B;u.prototype.divRemTo=j;u.prototype.invDigit=X;u.prototype.isEven=Y;u.prototype.exp=Z;u.prototype.toString=T;u.prototype.negate=N;u.prototype.abs=C;u.prototype.compareTo=k;u.prototype.bitLength=A;u.prototype.mod=F;u.prototype.modPowInt=et;u.ZERO=E(0);u.ONE=E(1);Xt.prototype.convert=Vt;Xt.prototype.revert=Vt;Xt.prototype.mulTo=$t;Xt.prototype.sqrTo=Jt;Yt.prototype.convert=Zt;Yt.prototype.revert=en;Yt.prototype.reduce=tn;Yt.prototype.mulTo=rn;Yt.prototype.sqrTo=nn;var fn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ln=(1<<26)/fn[fn.length-1];u.prototype.chunkSize=st;u.prototype.toRadix=ut;u.prototype.fromRadix=at;u.prototype.fromNumber=ft;u.prototype.bitwiseTo=dt;u.prototype.changeBit=Mt;u.prototype.addTo=Ht;u.prototype.dMultiply=zt;u.prototype.dAddOffset=Wt;u.prototype.multiplyLowerTo=Qt;u.prototype.multiplyUpperTo=Gt;u.prototype.modInt=un;u.prototype.millerRabin=hn;u.prototype.clone=tt;u.prototype.intValue=nt;u.prototype.byteValue=rt;u.prototype.shortValue=it;u.prototype.signum=ot;u.prototype.toByteArray=lt;u.prototype.equals=ct;u.prototype.min=ht;u.prototype.max=pt;u.prototype.and=mt;u.prototype.or=yt;u.prototype.xor=wt;u.prototype.andNot=St;u.prototype.not=xt;u.prototype.shiftLeft=Tt;u.prototype.shiftRight=Nt;u.prototype.getLowestSetBit=kt;u.prototype.bitCount=At;u.prototype.testBit=Ot;u.prototype.setBit=_t;u.prototype.clearBit=Dt;u.prototype.flipBit=Pt;u.prototype.add=Bt;u.prototype.subtract=jt;u.prototype.multiply=Ft;u.prototype.divide=qt;u.prototype.remainder=Rt;u.prototype.divideAndRemainder=Ut;u.prototype.modPow=sn;u.prototype.modInverse=an;u.prototype.pow=Kt;u.prototype.gcd=on;u.prototype.isProbablePrime=cn;u.prototype.square=It;r.Math_Abs_Int64=r.Math_Abs_Int32=r.Math_Abs_Double=function(e){return Math.abs(e)};r.Math_Max_Int32_Int32=function(e,t){return Math.max(e,t)};n.msie||n.opera||n.safari?r.Cast_Int32=function(e){return e|0}:r.Cast_Int32=function(e){return~~e};n.chrome?r.Cast_Int64=function(e){return e<-2147483648||e>2147483647?e<0?Math.ceil(e):Math.floor(e):~~e}:n.firefox&&typeof Number.toInteger=="function"?r.Cast_Int64=function(e){return Number.toInteger(e)}:n.msie7||n.msie8?r.Cast_Int64=function(e){return parseInt(e,10)}:n.msie?r.Cast_Int64=function(e){return e<-2147483648||e>2147483647?e<0?Math.ceil(e):Math.floor(e):e|0}:r.Cast_Int64=function(e){return e<0?Math.ceil(e):Math.floor(e)};r.Clear=function(e){e.length=0};r.MaxSteps=64;r.PI=3.141592653589793;r.PI2=6.283185307179586;r.IntPoint=function(){var e=arguments;if(e.length==1){this.X=e[0].X;this.Y=e[0].Y}if(e.length==2){this.X=e[0];this.Y=e[1]}};r.IntRect=function(){var e=arguments;if(e.length==4){var t=e[0],n=e[1],r=e[2],i=e[3];this.left=t;this.top=n;this.right=r;this.bottom=i}else{this.left=0;this.top=0;this.right=0;this.bottom=0}};r.Polygon=function(){return[]};r.Polygons=function(){return[[]]};r.ExPolygon=function(){this.outer=null;this.holes=null};r.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3};r.PolyType={ptSubject:0,ptClip:1};r.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};r.JoinType={jtSquare:0,jtRound:1,jtMiter:2};r.EdgeSide={esLeft:1,esRight:2};r.Protects={ipNone:0,ipLeft:1,ipRight:2,ipBoth:3};r.Direction={dRightToLeft:0,dLeftToRight:1};r.TEdge=function(){this.xbot=0;this.ybot=0;this.xcurr=0;this.ycurr=0;this.xtop=0;this.ytop=0;this.dx=0;this.deltaX=0;this.deltaY=0;this.tmpX=0;this.polyType=r.PolyType.ptSubject;this.side=null;this.windDelta=0;this.windCnt=0;this.windCnt2=0;this.outIdx=0;this.next=null;this.prev=null;this.nextInLML=null;this.nextInAEL=null;this.prevInAEL=null;this.nextInSEL=null;this.prevInSEL=null};r.IntersectNode=function(){this.edge1=null;this.edge2=null;this.pt=null;this.next=null};r.LocalMinima=function(){this.Y=0;this.leftBound=null;this.rightBound=null;this.next=null};r.Scanbeam=function(){this.Y=0;this.next=null};r.OutRec=function(){this.idx=0;this.isHole=!1;this.FirstLeft=null;this.AppendLink=null;this.pts=null;this.bottomPt=null};r.OutPt=function(){this.idx=0;this.pt=null;this.next=null;this.prev=null};r.JoinRec=function(){this.pt1a=null;this.pt1b=null;this.poly1Idx=0;this.pt2a=null;this.pt2b=null;this.poly2Idx=0};r.HorzJoinRec=function(){this.edge=null;this.savedIdx=0};r.ClipperBase=function(){this.m_MinimaList=null;this.m_CurrentLM=null;this.m_edges=[[]];this.m_UseFullRange=!1};r.ClipperBase.horizontal=-9007199254740992;r.ClipperBase.loRange=47453132;r.ClipperBase.hiRange=0xfffffffffffff;r.ClipperBase.PointsEqual=function(e,t){return e.X==t.X&&e.Y==t.Y};r.ClipperBase.prototype.PointIsVertex=function(e,t){var n=t;do{if(r.ClipperBase.PointsEqual(n.pt,e))return!0;n=n.next}while(n!=t);return!1};r.ClipperBase.prototype.PointInPolygon=function(e,t,n){var r=t,i=!1;if(n){do{(r.pt.Y<=e.Y&&e.Y<r.prev.pt.Y||r.prev.pt.Y<=e.Y&&e.Y<r.pt.Y)&&(new u(e.X-r.pt.X)).compareTo((new u(r.prev.pt.X-r.pt.X)).multiply(new u(e.Y-r.pt.Y)).divide(new u(r.prev.pt.Y-r.pt.Y)))<0&&(i=!i);r=r.next}while(r!=t)}else do{(r.pt.Y<=e.Y&&e.Y<r.prev.pt.Y||r.prev.pt.Y<=e.Y&&e.Y<r.pt.Y)&&e.X-r.pt.X<(r.prev.pt.X-r.pt.X)*(e.Y-r.pt.Y)/(r.prev.pt.Y-r.pt.Y)&&(i=!i);r=r.next}while(r!=t);return i};r.ClipperBase.prototype.SlopesEqual=function(){var e=arguments,t,n,r,i,s,o,a;if(e.length==3){t=e[0],n=e[1],a=e[2];return a?(new u(t.deltaY)).multiply(new u(n.deltaX)).toString()==(new u(t.deltaX)).multiply(new u(n.deltaY)).toString():t.deltaY*n.deltaX==t.deltaX*n.deltaY}if(e.length==4){r=e[0],i=e[1],s=e[2],a=e[3];return a?(new u(r.Y-i.Y)).multiply(new u(i.X-s.X)).toString()==(new u(r.X-i.X)).multiply(new u(i.Y-s.Y)).toString():(r.Y-i.Y)*(i.X-s.X)-(r.X-i.X)*(i.Y-s.Y)==0}if(e.length==5){r=e[0],i=e[1],s=e[2],o=e[3],a=e[4];return a?(new u(r.Y-i.Y)).multiply(new u(s.X-o.X)).toString()==(new u(r.X-i.X)).multiply(new u(s.Y-o.Y)).toString():(r.Y-i.Y)*(s.X-o.X)-(r.X-i.X)*(s.Y-o.Y)==0}};r.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var e=0;e<this.m_edges.length;++e){for(var t=0;t<this.m_edges[e].length;++t)this.m_edges[e][t]=null;r.Clear(this.m_edges[e])}r.Clear(this.m_edges);this.m_UseFullRange=!1};r.ClipperBase.prototype.DisposeLocalMinimaList=function(){while(this.m_MinimaList!=null){var e=this.m_MinimaList.next;this.m_MinimaList=null;this.m_MinimaList=e}this.m_CurrentLM=null};r.ClipperBase.prototype.AddPolygons=function(e,t){var n=!1,i=!1;if(e instanceof Array){for(var s=0;s<e.length;++s){i=this.AddPolygon(e[s],t,!0);if(i&&i!="exceed")n=!0;else if(i=="exceed")break}i=="exceed"&&r.Error("Coordinate exceeds range bounds in AddPolygons().");return n}return n};r.ClipperBase.prototype.AddPolygon=function(e,t,n){if(e instanceof Array){var i=e.length;if(i<3)return!1;var s=new r.Polygon;s.push(new r.IntPoint(e[0].X,e[0].Y));var o=0,u,a=!1;for(u=1;u<i;++u){var f;this.m_UseFullRange?f=r.ClipperBase.hiRange:f=r.ClipperBase.loRange;if(r.Math_Abs_Int64(e[u].X)>f||r.Math_Abs_Int64(e[u].Y)>f){if(r.Math_Abs_Int64(e[u].X)>r.ClipperBase.hiRange||r.Math_Abs_Int64(e[u].Y)>r.ClipperBase.hiRange){if(typeof n!="undefined")return"exceed";a=!0;break}f=r.ClipperBase.hiRange;this.m_UseFullRange=!0}if(r.ClipperBase.PointsEqual(s[o],e[u]))continue;o>0&&this.SlopesEqual(s[o-1],s[o],e[u],this.m_UseFullRange)?r.ClipperBase.PointsEqual(s[o-1],e[u])&&o--:o++;o<s.length?s[o]=e[u]:s.push(new r.IntPoint(e[u].X,e[u].Y))}a&&typeof n=="undefined"&&r.Error("Coordinate exceeds range bounds in AddPolygon()");if(o<2)return!1;i=o+1;while(i>2){if(r.ClipperBase.PointsEqual(s[o],s[0]))o--;else if(r.ClipperBase.PointsEqual(s[0],s[1])||this.SlopesEqual(s[o],s[0],s[1],this.m_UseFullRange))s[0]=s[o--];else if(this.SlopesEqual(s[o-1],s[o],s[0],this.m_UseFullRange))o--;else{if(!this.SlopesEqual(s[0],s[1],s[2],this.m_UseFullRange))break;for(u=2;u<=o;++u)s[u-1]=s[u];o--}i--}if(i<3)return!1;var l=[];for(u=0;u<i;u++)l.push(new r.TEdge);this.m_edges.push(l);l[0].xcurr=s[0].X;l[0].ycurr=s[0].Y;this.InitEdge(l[i-1],l[0],l[i-2],s[i-1],t);for(u=i-2;u>0;--u)this.InitEdge(l[u],l[u+1],l[u-1],s[u],t);this.InitEdge(l[0],l[1],l[i-1],s[0],t);var c=l[0],h=c;do{c.xcurr=c.xbot;c.ycurr=c.ybot;c.ytop<h.ytop&&(h=c);c=c.next}while(c!=l[0]);h.windDelta>0&&(h=h.next);h.dx==r.ClipperBase.horizontal&&(h=h.next);c=h;do c=this.AddBoundsToLML(c);while(c!=h);return!0}return!1};r.ClipperBase.prototype.InitEdge=function(e,t,n,r,i){e.next=t;e.prev=n;e.xcurr=r.X;e.ycurr=r.Y;if(e.ycurr>=e.next.ycurr){e.xbot=e.xcurr;e.ybot=e.ycurr;e.xtop=e.next.xcurr;e.ytop=e.next.ycurr;e.windDelta=1}else{e.xtop=e.xcurr;e.ytop=e.ycurr;e.xbot=e.next.xcurr;e.ybot=e.next.ycurr;e.windDelta=-1}this.SetDx(e);e.polyType=i;e.outIdx=-1};r.ClipperBase.prototype.SetDx=function(e){e.deltaX=e.xtop-e.xbot;e.deltaY=e.ytop-e.ybot;e.deltaY==0?e.dx=r.ClipperBase.horizontal:e.dx=e.deltaX/e.deltaY};r.ClipperBase.prototype.AddBoundsToLML=function(e){e.nextInLML=null;e=e.next;for(;;){if(e.dx==r.ClipperBase.horizontal){if(e.next.ytop<e.ytop&&e.next.xbot>e.prev.xbot)break;e.xtop!=e.prev.xbot&&this.SwapX(e);e.nextInLML=e.prev}else{if(e.ycurr==e.prev.ycurr)break;e.nextInLML=e.prev}e=e.next}var t=new r.LocalMinima;t.next=null;t.Y=e.prev.ybot;if(e.dx==r.ClipperBase.horizontal){e.xbot!=e.prev.xbot&&this.SwapX(e);t.leftBound=e.prev;t.rightBound=e}else if(e.dx<e.prev.dx){t.leftBound=e.prev;t.rightBound=e}else{t.leftBound=e;t.rightBound=e.prev}t.leftBound.side=r.EdgeSide.esLeft;t.rightBound.side=r.EdgeSide.esRight;this.InsertLocalMinima(t);for(;;){if(e.next.ytop==e.ytop&&e.next.dx!=r.ClipperBase.horizontal)break;e.nextInLML=e.next;e=e.next;e.dx==r.ClipperBase.horizontal&&e.xbot!=e.prev.xtop&&this.SwapX(e)}return e.next};r.ClipperBase.prototype.InsertLocalMinima=function(e){if(this.m_MinimaList==null)this.m_MinimaList=e;else if(e.Y>=this.m_MinimaList.Y){e.next=this.m_MinimaList;this.m_MinimaList=e}else{var t=this.m_MinimaList;while(t.next!=null&&e.Y<t.next.Y)t=t.next;e.next=t.next;t.next=e}};r.ClipperBase.prototype.PopLocalMinima=function(){if(this.m_CurrentLM==null)return;this.m_CurrentLM=this.m_CurrentLM.next};r.ClipperBase.prototype.SwapX=function(e){e.xcurr=e.xtop;e.xtop=e.xbot;e
.xbot=e.xcurr};r.ClipperBase.prototype.Reset=function(){this.m_CurrentLM=this.m_MinimaList;var e=this.m_MinimaList;while(e!=null){var t=e.leftBound;while(t!=null){t.xcurr=t.xbot;t.ycurr=t.ybot;t.side=r.EdgeSide.esLeft;t.outIdx=-1;t=t.nextInLML}t=e.rightBound;while(t!=null){t.xcurr=t.xbot;t.ycurr=t.ybot;t.side=r.EdgeSide.esRight;t.outIdx=-1;t=t.nextInLML}e=e.next}return};r.ClipperBase.prototype.GetBounds=function(){var e=new r.IntRect,t=this.m_MinimaList;if(t==null)return e;e.left=t.leftBound.xbot;e.top=t.leftBound.ybot;e.right=t.leftBound.xbot;e.bottom=t.leftBound.ybot;while(t!=null){t.leftBound.ybot>e.bottom&&(e.bottom=t.leftBound.ybot);var n=t.leftBound;for(;;){var i=n;while(n.nextInLML!=null){n.xbot<e.left&&(e.left=n.xbot);n.xbot>e.right&&(e.right=n.xbot);n=n.nextInLML}n.xbot<e.left&&(e.left=n.xbot);n.xbot>e.right&&(e.right=n.xbot);n.xtop<e.left&&(e.left=n.xtop);n.xtop>e.right&&(e.right=n.xtop);n.ytop<e.top&&(e.top=n.ytop);if(i!=t.leftBound)break;n=t.rightBound}t=t.next}return e};r.Clipper=function(){this.m_PolyOuts=null;this.m_ClipType=r.ClipType.ctIntersection;this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.m_IntersectNodes=null;this.m_ExecuteLocked=!1;this.m_ClipFillType=r.PolyFillType.pftEvenOdd;this.m_SubjFillType=r.PolyFillType.pftEvenOdd;this.m_Joins=null;this.m_HorizJoins=null;this.m_ReverseOutput=!1;this.m_UsingExPolygons=!1;r.ClipperBase.call(this);this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.m_IntersectNodes=null;this.m_ExecuteLocked=!1;this.m_PolyOuts=[];this.m_Joins=[];this.m_HorizJoins=[];this.m_ReverseOutput=!1;this.m_UsingExPolygons=!1};r.Clipper.prototype.Clear=function(){if(this.m_edges.length==0)return;this.DisposeAllPolyPts();r.ClipperBase.prototype.Clear.call(this)};r.Clipper.prototype.DisposeScanbeamList=function(){while(this.m_Scanbeam!=null){var e=this.m_Scanbeam.next;this.m_Scanbeam=null;this.m_Scanbeam=e}};r.Clipper.prototype.Reset=function(){r.ClipperBase.prototype.Reset.call(this);this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.DisposeAllPolyPts();var e=this.m_MinimaList;while(e!=null){this.InsertScanbeam(e.Y);this.InsertScanbeam(e.leftBound.ytop);e=e.next}};r.Clipper.prototype.get_ReverseSolution=function(){return this.m_ReverseOutput};r.Clipper.prototype.set_ReverseSolution=function(e){this.m_ReverseOutput=e};r.Clipper.prototype.InsertScanbeam=function(e){var t;if(this.m_Scanbeam==null){this.m_Scanbeam=new r.Scanbeam;this.m_Scanbeam.next=null;this.m_Scanbeam.Y=e}else if(e>this.m_Scanbeam.Y){t=new r.Scanbeam;t.Y=e;t.next=this.m_Scanbeam;this.m_Scanbeam=t}else{var n=this.m_Scanbeam;while(n.next!=null&&e<=n.next.Y)n=n.next;if(e==n.Y)return;t=new r.Scanbeam;t.Y=e;t.next=n.next;n.next=t}};r.Clipper.prototype.Execute=function(e,t,n,i){var s;if(arguments.length==2){n=r.PolyFillType.pftEvenOdd;i=r.PolyFillType.pftEvenOdd}if(!t.hasOwnProperty("outer")){if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0;r.Clear(t);this.m_SubjFillType=n;this.m_ClipFillType=i;this.m_ClipType=e;this.m_UsingExPolygons=!1;s=this.ExecuteInternal();s&&this.BuildResult(t);this.m_ExecuteLocked=!1;return s}if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0;r.Clear(t);this.m_SubjFillType=n;this.m_ClipFillType=i;this.m_ClipType=e;this.m_UsingExPolygons=!0;s=this.ExecuteInternal();s&&this.BuildResultEx(t);this.m_ExecuteLocked=!1;return s};r.Clipper.prototype.PolySort=function(e,t){if(e==t)return 0;if(e.pts==null||t.pts==null)return e.pts==null!=(t.pts==null)?e.pts==null?1:-1:0;var n,r;e.isHole?n=e.FirstLeft.idx:n=e.idx;t.isHole?r=t.FirstLeft.idx:r=t.idx;var i=n-r;return i==0&&e.isHole!=t.isHole?e.isHole?1:-1:i};r.Clipper.prototype.FindAppendLinkEnd=function(e){while(e.AppendLink!=null)e=e.AppendLink;return e};r.Clipper.prototype.FixHoleLinkage=function(e){var t;e.bottomPt!=null?t=this.m_PolyOuts[e.bottomPt.idx].FirstLeft:t=e.FirstLeft;e==t&&r.Error("HoleLinkage error");if(t!=null){t.AppendLink!=null&&(t=this.FindAppendLinkEnd(t));if(t==e)t=null;else if(t.isHole){this.FixHoleLinkage(t);t=t.FirstLeft}}e.FirstLeft=t;t==null&&(e.isHole=!1);e.AppendLink=null};r.Clipper.prototype.ExecuteInternal=function(){var e;try{this.Reset();if(this.m_CurrentLM==null)return!0;var t=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(t);r.Clear(this.m_HorizJoins);this.ProcessHorizontals();var n=this.PopScanbeam();e=this.ProcessIntersections(t,n);if(!e)break;this.ProcessEdgesAtTopOfScanbeam(n);t=n}while(this.m_Scanbeam!=null)}catch(i){e=!1}if(e){var s;for(var o=0;o<this.m_PolyOuts.length;o++){s=this.m_PolyOuts[o];if(s.pts==null)continue;this.FixupOutPolygon(s);if(s.pts==null)continue;s.isHole&&this.m_UsingExPolygons&&this.FixHoleLinkage(s);(s.isHole^this.m_ReverseOutput)==this.Area(s,this.m_UseFullRange)>0&&this.ReversePolyPtLinks(s.pts)}this.JoinCommonEdges();this.m_UsingExPolygons&&this.m_PolyOuts.sort(this.PolySort)}r.Clear(this.m_Joins);r.Clear(this.m_HorizJoins);return e};r.Clipper.prototype.PopScanbeam=function(){var e=this.m_Scanbeam.Y,t=this.m_Scanbeam;this.m_Scanbeam=this.m_Scanbeam.next;t=null;return e};r.Clipper.prototype.DisposeAllPolyPts=function(){for(var e=0;e<this.m_PolyOuts.length;++e)this.DisposeOutRec(e);r.Clear(this.m_PolyOuts)};r.Clipper.prototype.DisposeOutRec=function(e){var t=this.m_PolyOuts[e];t.pts!=null&&this.DisposeOutPts(t.pts);t=null;this.m_PolyOuts[e]=null};r.Clipper.prototype.DisposeOutPts=function(e){if(e==null)return;var t=null;e.prev.next=null;while(e!=null){t=e;e=e.next;t=null}};r.Clipper.prototype.AddJoin=function(e,t,n,i){var s=new r.JoinRec;n>=0?s.poly1Idx=n:s.poly1Idx=e.outIdx;s.pt1a=new r.IntPoint(e.xcurr,e.ycurr);s.pt1b=new r.IntPoint(e.xtop,e.ytop);i>=0?s.poly2Idx=i:s.poly2Idx=t.outIdx;s.pt2a=new r.IntPoint(t.xcurr,t.ycurr);s.pt2b=new r.IntPoint(t.xtop,t.ytop);this.m_Joins.push(s)};r.Clipper.prototype.AddHorzJoin=function(e,t){var n=new r.HorzJoinRec;n.edge=e;n.savedIdx=t;this.m_HorizJoins.push(n)};r.Clipper.prototype.InsertLocalMinimaIntoAEL=function(e){var t,n;while(this.m_CurrentLM!=null&&this.m_CurrentLM.Y==e){var i=this.m_CurrentLM.leftBound,s=this.m_CurrentLM.rightBound;this.InsertEdgeIntoAEL(i);this.InsertScanbeam(i.ytop);this.InsertEdgeIntoAEL(s);if(this.IsEvenOddFillType(i)){i.windDelta=1;s.windDelta=1}else s.windDelta=-i.windDelta;this.SetWindingCount(i);s.windCnt=i.windCnt;s.windCnt2=i.windCnt2;if(s.dx==r.ClipperBase.horizontal){this.AddEdgeToSEL(s);this.InsertScanbeam(s.nextInLML.ytop)}else this.InsertScanbeam(s.ytop);this.IsContributing(i)&&this.AddLocalMinPoly(i,s,new r.IntPoint(i.xcurr,this.m_CurrentLM.Y));if(s.outIdx>=0&&s.dx==r.ClipperBase.horizontal)for(var o=0;o<this.m_HorizJoins.length;o++){t=new r.IntPoint,n=new r.IntPoint;var u=this.m_HorizJoins[o];(function(){t={Value:t};n={Value:n};var e=this.GetOverlapSegment(new r.IntPoint(u.edge.xbot,u.edge.ybot),new r.IntPoint(u.edge.xtop,u.edge.ytop),new r.IntPoint(s.xbot,s.ybot),new r.IntPoint(s.xtop,s.ytop),t,n);t=t.Value;n=n.Value;return e}).call(this)&&this.AddJoin(u.edge,s,u.savedIdx,-1)}if(i.nextInAEL!=s){s.outIdx>=0&&s.prevInAEL.outIdx>=0&&this.SlopesEqual(s.prevInAEL,s,this.m_UseFullRange)&&this.AddJoin(s,s.prevInAEL,-1,-1);var a=i.nextInAEL;t=new r.IntPoint(i.xcurr,i.ycurr);while(a!=s){a==null&&r.Error("InsertLocalMinimaIntoAEL: missing rightbound!");this.IntersectEdges(s,a,t,r.Protects.ipNone);a=a.nextInAEL}}this.PopLocalMinima()}};r.Clipper.prototype.InsertEdgeIntoAEL=function(e){e.prevInAEL=null;e.nextInAEL=null;if(this.m_ActiveEdges==null)this.m_ActiveEdges=e;else if(this.E2InsertsBeforeE1(this.m_ActiveEdges,e)){e.nextInAEL=this.m_ActiveEdges;this.m_ActiveEdges.prevInAEL=e;this.m_ActiveEdges=e}else{var t=this.m_ActiveEdges;while(t.nextInAEL!=null&&!this.E2InsertsBeforeE1(t.nextInAEL,e))t=t.nextInAEL;e.nextInAEL=t.nextInAEL;t.nextInAEL!=null&&(t.nextInAEL.prevInAEL=e);e.prevInAEL=t;t.nextInAEL=e}};r.Clipper.prototype.E2InsertsBeforeE1=function(e,t){return t.xcurr==e.xcurr?t.dx>e.dx:t.xcurr<e.xcurr};r.Clipper.prototype.IsEvenOddFillType=function(e){return e.polyType==r.PolyType.ptSubject?this.m_SubjFillType==r.PolyFillType.pftEvenOdd:this.m_ClipFillType==r.PolyFillType.pftEvenOdd};r.Clipper.prototype.IsEvenOddAltFillType=function(e){return e.polyType==r.PolyType.ptSubject?this.m_ClipFillType==r.PolyFillType.pftEvenOdd:this.m_SubjFillType==r.PolyFillType.pftEvenOdd};r.Clipper.prototype.IsContributing=function(e){var t,n;if(e.polyType==r.PolyType.ptSubject){t=this.m_SubjFillType;n=this.m_ClipFillType}else{t=this.m_ClipFillType;n=this.m_SubjFillType}switch(t){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:if(r.Math_Abs_Int32(e.windCnt)!=1)return!1;break;case r.PolyFillType.pftPositive:if(e.windCnt!=1)return!1;break;default:if(e.windCnt!=-1)return!1}switch(this.m_ClipType){case r.ClipType.ctIntersection:switch(n){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return e.windCnt2!=0;case r.PolyFillType.pftPositive:return e.windCnt2>0;default:return e.windCnt2<0}break;case r.ClipType.ctUnion:switch(n){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return e.windCnt2==0;case r.PolyFillType.pftPositive:return e.windCnt2<=0;default:return e.windCnt2>=0}break;case r.ClipType.ctDifference:if(e.polyType==r.PolyType.ptSubject)switch(n){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return e.windCnt2==0;case r.PolyFillType.pftPositive:return e.windCnt2<=0;default:return e.windCnt2>=0}else switch(n){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return e.windCnt2!=0;case r.PolyFillType.pftPositive:return e.windCnt2>0;default:return e.windCnt2<0}}return!0};r.Clipper.prototype.SetWindingCount=function(e){var t=e.prevInAEL;while(t!=null&&t.polyType!=e.polyType)t=t.prevInAEL;if(t==null){e.windCnt=e.windDelta;e.windCnt2=0;t=this.m_ActiveEdges}else if(this.IsEvenOddFillType(e)){e.windCnt=1;e.windCnt2=t.windCnt2;t=t.nextInAEL}else{t.windCnt*t.windDelta<0?r.Math_Abs_Int32(t.windCnt)>1?t.windDelta*e.windDelta<0?e.windCnt=t.windCnt:e.windCnt=t.windCnt+e.windDelta:e.windCnt=t.windCnt+t.windDelta+e.windDelta:r.Math_Abs_Int32(t.windCnt)>1&&t.windDelta*e.windDelta<0?e.windCnt=t.windCnt:t.windCnt+e.windDelta==0?e.windCnt=t.windCnt:e.windCnt=t.windCnt+e.windDelta;e.windCnt2=t.windCnt2;t=t.nextInAEL}if(this.IsEvenOddAltFillType(e))while(t!=e){e.windCnt2=e.windCnt2==0?1:0;t=t.nextInAEL}else while(t!=e){e.windCnt2+=t.windDelta;t=t.nextInAEL}};r.Clipper.prototype.AddEdgeToSEL=function(e){if(this.m_SortedEdges==null){this.m_SortedEdges=e;e.prevInSEL=null;e.nextInSEL=null}else{e.nextInSEL=this.m_SortedEdges;e.prevInSEL=null;this.m_SortedEdges.prevInSEL=e;this.m_SortedEdges=e}};r.Clipper.prototype.CopyAELToSEL=function(){var e=this.m_ActiveEdges;this.m_SortedEdges=e;if(this.m_ActiveEdges==null)return;this.m_SortedEdges.prevInSEL=null;e=e.nextInAEL;while(e!=null){e.prevInSEL=e.prevInAEL;e.prevInSEL.nextInSEL=e;e.nextInSEL=null;e=e.nextInAEL}};r.Clipper.prototype.SwapPositionsInAEL=function(e,t){var n,r;if(e.nextInAEL==null&&e.prevInAEL==null)return;if(t.nextInAEL==null&&t.prevInAEL==null)return;if(e.nextInAEL==t){n=t.nextInAEL;n!=null&&(n.prevInAEL=e);r=e.prevInAEL;r!=null&&(r.nextInAEL=t);t.prevInAEL=r;t.nextInAEL=e;e.prevInAEL=t;e.nextInAEL=n}else if(t.nextInAEL==e){n=e.nextInAEL;n!=null&&(n.prevInAEL=t);r=t.prevInAEL;r!=null&&(r.nextInAEL=e);e.prevInAEL=r;e.nextInAEL=t;t.prevInAEL=e;t.nextInAEL=n}else{n=e.nextInAEL;r=e.prevInAEL;e.nextInAEL=t.nextInAEL;e.nextInAEL!=null&&(e.nextInAEL.prevInAEL=e);e.prevInAEL=t.prevInAEL;e.prevInAEL!=null&&(e.prevInAEL.nextInAEL=e);t.nextInAEL=n;t.nextInAEL!=null&&(t.nextInAEL.prevInAEL=t);t.prevInAEL=r;t.prevInAEL!=null&&(t.prevInAEL.nextInAEL=t)}e.prevInAEL==null?this.m_ActiveEdges=e:t.prevInAEL==null&&(this.m_ActiveEdges=t)};r.Clipper.prototype.SwapPositionsInSEL=function(e,t){var n,r;if(e.nextInSEL==null&&e.prevInSEL==null)return;if(t.nextInSEL==null&&t.prevInSEL==null)return;if(e.nextInSEL==t){n=t.nextInSEL;n!=null&&(n.prevInSEL=e);r=e.prevInSEL;r!=null&&(r.nextInSEL=t);t.prevInSEL=r;t.nextInSEL=e;e.prevInSEL=t;e.nextInSEL=n}else if(t.nextInSEL==e){n=e.nextInSEL;n!=null&&(n.prevInSEL=t);r=t.prevInSEL;r!=null&&(r.nextInSEL=e);e.prevInSEL=r;e.nextInSEL=t;t.prevInSEL=e;t.nextInSEL=n}else{n=e.nextInSEL;r=e.prevInSEL;e.nextInSEL=t.nextInSEL;e.nextInSEL!=null&&(e.nextInSEL.prevInSEL=e);e.prevInSEL=t.prevInSEL;e.prevInSEL!=null&&(e.prevInSEL.nextInSEL=e);t.nextInSEL=n;t.nextInSEL!=null&&(t.nextInSEL.prevInSEL=t);t.prevInSEL=r;t.prevInSEL!=null&&(t.prevInSEL.nextInSEL=t)}e.prevInSEL==null?this.m_SortedEdges=e:t.prevInSEL==null&&(this.m_SortedEdges=t)};r.Clipper.prototype.AddLocalMaxPoly=function(e,t,n){this.AddOutPt(e,n);if(e.outIdx==t.outIdx){e.outIdx=-1;t.outIdx=-1}else e.outIdx<t.outIdx?this.AppendPolygon(e,t):this.AppendPolygon(t,e)};r.Clipper.prototype.AddLocalMinPoly=function(e,t,n){var i,s;if(t.dx==r.ClipperBase.horizontal||e.dx>t.dx){this.AddOutPt(e,n);t.outIdx=e.outIdx;e.side=r.EdgeSide.esLeft;t.side=r.EdgeSide.esRight;i=e;i.prevInAEL==t?s=t.prevInAEL:s=i.prevInAEL}else{this.AddOutPt(t,n);e.outIdx=t.outIdx;e.side=r.EdgeSide.esRight;t.side=r.EdgeSide.esLeft;i=t;i.prevInAEL==e?s=e.prevInAEL:s=i.prevInAEL}s!=null&&s.outIdx>=0&&r.Clipper.TopX(s,n.Y)==r.Clipper.TopX(i,n.Y)&&this.SlopesEqual(i,s,this.m_UseFullRange)&&this.AddJoin(i,s,-1,-1)};r.Clipper.prototype.CreateOutRec=function(){var e=new r.OutRec;e.idx=-1;e.isHole=!1;e.FirstLeft=null;e.AppendLink=null;e.pts=null;e.bottomPt=null;return e};r.Clipper.prototype.AddOutPt=function(e,t){var n,i,s=e.side==r.EdgeSide.esLeft;if(e.outIdx<0){n=this.CreateOutRec();this.m_PolyOuts.push(n);n.idx=this.m_PolyOuts.length-1;e.outIdx=n.idx;i=new r.OutPt;n.pts=i;n.bottomPt=i;i.pt=t;i.idx=n.idx;i.next=i;i.prev=i;this.SetHoleState(e,n)}else{n=this.m_PolyOuts[e.outIdx];i=n.pts;var o;if(s&&r.ClipperBase.PointsEqual(t,i.pt)||!s&&r.ClipperBase.PointsEqual(t,i.prev.pt))return;o=new r.OutPt;o.pt=t;o.idx=n.idx;o.pt.Y==n.bottomPt.pt.Y&&o.pt.X<n.bottomPt.pt.X&&(n.bottomPt=o);o.next=i;o.prev=i.prev;o.prev.next=o;i.prev=o;s&&(n.pts=o)}};r.Clipper.prototype.SwapPoints=function(e,t){var n=e.Value;e.Value=t.Value;t.Value=n};r.Clipper.prototype.GetOverlapSegment=function(e,t,n,i,s,o){if(r.Math_Abs_Int64(e.X-t.X)>r.Math_Abs_Int64(e.Y-t.Y)){e.X>t.X&&function(){e={Value:e};t={Value:t};var n=this.SwapPoints(e,t);e=e.Value;t=t.Value;return n}.call(this);n.X>i.X&&function(){n={Value:n};i={Value:i};var e=this.SwapPoints(n,i);n=n.Value;i=i.Value;return e}.call(this);e.X>n.X?s.Value=e:s.Value=n;t.X<i.X?o.Value=t:o.Value=i;return s.Value.X<o.Value.X}e.Y<t.Y&&function(){e={Value:e};t={Value:t};var n=this.SwapPoints(e,t);e=e.Value;t=t.Value;return n}.call(this);n.Y<i.Y&&function(){n={Value:n};i={Value:i};var e=this.SwapPoints(n,i);n=n.Value;i=i.Value;return e}.call(this);e.Y<n.Y?s.Value=e:s.Value=n;t.Y>i.Y?o.Value=t:o.Value=i;return s.Value.Y>o.Value.Y};r.Clipper.prototype.FindSegment=function(e,t,n){if(e.Value==null)return!1;var i=e.Value,s=new r.IntPoint(t.Value),o=new r.IntPoint(n.Value);do{if(this.SlopesEqual(s,o,e.Value.pt,e.Value.prev.pt,!0)&&this.SlopesEqual(s,o,e.Value.pt,!0)&&this.GetOverlapSegment(s,o,e.Value.pt,e.Value.prev.pt,t,n))return!0;e.Value=e.Value.next}while(e.Value!=i);return!1};r.Clipper.prototype.Pt3IsBetweenPt1AndPt2=function(e,t,n){return r.ClipperBase.PointsEqual(e,n)||r.ClipperBase.PointsEqual(t,n)?!0:e.X!=t.X?e.X<n.X==n.X<t.X:e.Y<n.Y==n.Y<t.Y};r.Clipper.prototype.InsertPolyPtBetween=function(e,t,n){var i=new r.OutPt;i.pt=n;if(t==e.next){e.next=i;t.prev=i;i.next=t;i.prev=e}else{t.next=i;e.prev=i;i.next=e;i.prev=t}return i};r.Clipper.prototype.SetHoleState=function(e,t){var n=!1,r=e.prevInAEL;while(r!=null){if(r.outIdx>=0){n=!n;t.FirstLeft==null&&(t.FirstLeft=this.m_PolyOuts[r.outIdx])}r=r.prevInAEL}n&&(t.isHole=!0)};r.Clipper.prototype.GetDx=function(e,t){return e.Y==t.Y?r.ClipperBase.horizontal:(t.X-e.X)/(t.Y-e.Y)};r.Clipper.prototype.FirstIsBottomPt=function(e,t){var n=e.prev;while(r.ClipperBase.PointsEqual(n.pt,e.pt)&&n!=e)n=n.prev;var i=r.Math_Abs_Double(this.GetDx(e.pt,n.pt));n=e.next;while(r.ClipperBase.PointsEqual(n.pt,e.pt)&&n!=e)n=n.next;var s=r.Math_Abs_Double(this.GetDx(e.pt,n.pt));n=t.prev;while(r.ClipperBase.PointsEqual(n.pt,t.pt)&&n!=t)n=n.prev;var o=r.Math_Abs_Double(this.GetDx(t.pt,n.pt));n=t.next;while(r.ClipperBase.PointsEqual(n.pt,t.pt)&&n!=t)n=n.next;var u=r.Math_Abs_Double(this.GetDx(t.pt,n.pt));return i>=o&&i>=u||s>=o&&s>=u};r.Clipper.prototype.GetBottomPt=function(e){var t=null,n=e.next;while(n!=e){if(n.pt.Y>e.pt.Y){e=n;t=null}else if(n.pt.Y==e.pt.Y&&n.pt.X<=e.pt.X)if(n.pt.X<e.pt.X){t=null;e=n}else n.next!=e&&n.prev!=e&&(t=n);n=n.next}if(t!=null)while(t!=n){this.FirstIsBottomPt(n,t)||(e=t);t=t.next;while(!r.ClipperBase.PointsEqual(t.pt,e.pt))t=t.next}return e};r.Clipper.prototype.GetLowermostRec=function(e,t){var n=e.bottomPt,r=t.bottomPt;return n.pt.Y>r.pt.Y?e:n.pt.Y<r.pt.Y?t:n.pt.X<r.pt.X?e:n.pt.X>r.pt.X?t:n.next==n?t:r.next==r?e:this.FirstIsBottomPt(n,r)?e:t};r.Clipper.prototype.Param1RightOfParam2=function(e,t){do{e=e.FirstLeft;if(e==t)return!0}while(e!=null);return!1};r.Clipper.prototype.AppendPolygon=function(e,t){var n=this.m_PolyOuts[e.outIdx],i=this.m_PolyOuts[t.outIdx],s;this.Param1RightOfParam2(n,i)?s=i:this.Param1RightOfParam2(i,n)?s=n:s=this.GetLowermostRec(n,i);var o=n.pts,u=o.prev,a=i.pts,f=a.prev,l,c;if(e.side==r.EdgeSide.esLeft){if(t.side==r.EdgeSide.esLeft){this.ReversePolyPtLinks(a);a.next=o;o.prev=a;u.next=f;f.prev=u;n.pts=f}else{f.next=o;o.prev=f;a.prev=u;u.next=a;n.pts=a}l=r.EdgeSide.esLeft}else{if(t.side==r.EdgeSide.esRight){this.ReversePolyPtLinks(a);u.next=f;f.prev=u;a.next=o;o.prev=a}else{u.next=a;a.prev=u;o.prev=f;f.next=o}l=r.EdgeSide.esRight}if(s==i){n.bottomPt=i.bottomPt;n.bottomPt.idx=n.idx;i.FirstLeft!=n&&(n.FirstLeft=i.FirstLeft);n.isHole=i.isHole}i.pts=null;i.bottomPt=null;i.AppendLink=n;var h=e.outIdx,p=t.outIdx;e.outIdx=-1;t.outIdx=-1;var d=this.m_ActiveEdges;while(d!=null){if(d.outIdx==p){d.outIdx=h;d.side=l;break}d=d.nextInAEL}for(c=0;c<this.m_Joins.length;++c){this.m_Joins[c].poly1Idx==p&&(this.m_Joins[c].poly1Idx=h);this.m_Joins[c].poly2Idx==p&&(this.m_Joins[c].poly2Idx=h)}for(c=0;c<this.m_HorizJoins.length;++c)this.m_HorizJoins[c].savedIdx==p&&(this.m_HorizJoins[c].savedIdx=h)};r.Clipper.prototype.ReversePolyPtLinks=function(e){if(e==null)return;var t,n;t=e;do{n=t.next;t.next=t.prev;t.prev=n;t=n}while(t!=e)};r.Clipper.SwapSides=function(e,t){var n=e.side;e.side=t.side;t.side=n};r.Clipper.SwapPolyIndexes=function(e,t){var n=e.outIdx;e.outIdx=t.outIdx;t.outIdx=n};r.Clipper.prototype.DoEdge1=function(e,t,n){this.AddOutPt(e,n);r.Clipper.SwapSides(e,t);r.Clipper.SwapPolyIndexes(e,t)};r.Clipper.prototype.DoEdge2=function(e,t,n){this.AddOutPt(t,n);r.Clipper.SwapSides(e,t);r.Clipper.SwapPolyIndexes(e,t)};r.Clipper.prototype.DoBothEdges=function(e,t,n){this.AddOutPt(e,n);this.AddOutPt(t,n);r.Clipper.SwapSides(e,t);r.Clipper.SwapPolyIndexes(e,t)};r.Clipper.prototype.IntersectEdges=function(e,t,n,i){var s=(r.Protects.ipLeft&i)==0&&e.nextInLML==null&&e.xtop==n.X&&e.ytop==n.Y,o=(r.Protects.ipRight&i)==0&&t.nextInLML==null&&t.xtop==n.X&&t.ytop==n.Y,u=e.outIdx>=0,a=t.outIdx>=0;if(e.polyType==t.polyType)if(this.IsEvenOddFillType(e)){var f=e.windCnt;e.windCnt=t.windCnt;t.windCnt=f}else{e.windCnt+t.windDelta==0?e.windCnt=-e.windCnt:e.windCnt+=t.windDelta;t.windCnt-e.windDelta==0?t.windCnt=-t.windCnt:t.windCnt-=e.windDelta}else{this.IsEvenOddFillType(t)?e.windCnt2=e.windCnt2==0?1:0:e.windCnt2+=t.windDelta;this.IsEvenOddFillType(e)?t.windCnt2=t.windCnt2==0?1:0:t.windCnt2-=e.windDelta}var l,c,h,p;if(e.polyType==r.PolyType.ptSubject){l=this.m_SubjFillType;h=this.m_ClipFillType}else{l=this.m_ClipFillType;h=this.m_SubjFillType}if(t.polyType==r.PolyType.ptSubject){c=this.m_SubjFillType;p=this.m_ClipFillType}else{c=this.m_ClipFillType;p=this.m_SubjFillType}var d,v;switch(l){case r.PolyFillType.pftPositive:d=e.windCnt;break;case r.PolyFillType.pftNegative:d=-e.windCnt;break;default:d=r.Math_Abs_Int32(e.windCnt)}switch(c){case r.PolyFillType.pftPositive:v=t.windCnt;break;case r.PolyFillType.pftNegative:v=-t.windCnt;break;default:v=r.Math_Abs_Int32(t.windCnt)}if(u&&a)s||o||d!=0&&d!=1||v!=0&&v!=1||e.polyType!=t.polyType&&this.m_ClipType!=r.ClipType.ctXor?this.AddLocalMaxPoly(e,t,n):this.DoBothEdges(e,t,n);else if(u)(v==0||v==1)&&(this.m_ClipType!=r.ClipType.ctIntersection||t.polyType==r.PolyType.ptSubject||t.windCnt2!=0)&&this.DoEdge1(e,t,n);else if(a)(d==0||d==1)&&(this.m_ClipType!=r.ClipType.ctIntersection||e.polyType==r.PolyType.ptSubject||e.windCnt2!=0)&&this.DoEdge2(e,t,n);else if((d==0||d==1)&&(v==0||v==1)&&!s&&!o){var m,g;switch(h){case r.PolyFillType.pftPositive:m=e.windCnt2;break;case r.PolyFillType.pftNegative:m=-e.windCnt2;break;default:m=r.Math_Abs_Int32(e.windCnt2)}switch(p){case r.PolyFillType.pftPositive:g=t.windCnt2;break;case r.PolyFillType.pftNegative:g=-t.windCnt2;break;default:g=r.Math_Abs_Int32(t.windCnt2)}if(e.polyType!=t.polyType)this.AddLocalMinPoly(e,t,n);else if(d==1&&v==1)switch(this.m_ClipType){case r.ClipType.ctIntersection:m>0&&g>0&&this.AddLocalMinPoly(e,t,n);break;case r.ClipType.ctUnion:m<=0&&g<=0&&this.AddLocalMinPoly(e,t,n);break;case r.ClipType.ctDifference:(e.polyType==r.PolyType.ptClip&&m>0&&g>0||e.polyType==r.PolyType.ptSubject&&m<=0&&g<=0)&&this.AddLocalMinPoly(e,t,n);break;case r.ClipType.ctXor:this.AddLocalMinPoly(e,t,n)}else r.Clipper.SwapSides(e,t)}if(s!=o&&(s&&e.outIdx>=0||o&&t.outIdx>=0)){r.Clipper.SwapSides(e,t);r.Clipper.SwapPolyIndexes(e,t)}s&&this.DeleteFromAEL(e);o&&this.DeleteFromAEL(t)};r.Clipper.prototype.DeleteFromAEL=function(e){var t=e.prevInAEL,n=e.nextInAEL;if(t==null&&n==null&&e!=this.m_ActiveEdges)return;t!=null?t.nextInAEL=n:this.m_ActiveEdges=n;n!=null&&(n.prevInAEL=t);e.nextInAEL=null;e.prevInAEL=null};r.Clipper.prototype.DeleteFromSEL=function(e){var t=e.prevInSEL,n=e.nextInSEL;if(t==null&&n==null&&e!=this.m_SortedEdges)return;t!=null?t.nextInSEL=n:this.m_SortedEdges=n;n!=null&&(n.prevInSEL=t);e.nextInSEL=null;e.prevInSEL=null};r.Clipper.prototype.UpdateEdgeIntoAEL=function(e){e.Value.nextInLML==null&&r.Error("UpdateEdgeIntoAEL: invalid call");var t=e.Value.prevInAEL,n=e.Value.nextInAEL;e.Value.nextInLML.outIdx=e.Value.outIdx;t!=null?t.nextInAEL=e.Value.nextInLML:this.m_ActiveEdges=e.Value.nextInLML;n!=null&&(n.prevInAEL=e.Value.nextInLML);e.Value.nextInLML.side=e.Value.side;e.Value.nextInLML.windDelta=e.Value.windDelta;e.Value.nextInLML.windCnt=e.Value.windCnt;e.Value.nextInLML.windCnt2=e.Value.windCnt2;e.Value=e.Value.nextInLML;e.Value.prevInAEL=t;e.Value.nextInAEL=n;e.Value.dx!=r.ClipperBase.horizontal&&this.InsertScanbeam(e.Value.ytop)};r.Clipper.prototype.ProcessHorizontals=function(){var e=this.m_SortedEdges;while(e!=null){this.DeleteFromSEL(e);this.ProcessHorizontal(e);e=this.m_SortedEdges}};r.Clipper.prototype.ProcessHorizontal=function(e){var t,n,i;if(e.xcurr<e.xtop){n=e.xcurr;i=e.xtop;t=r.Direction.dLeftToRight}else{n=e.xtop;i=e.xcurr;t=r.Direction.dRightToLeft}var s;e.nextInLML!=null?s=null:s=this.GetMaximaPair(e);var o=this.GetNextInAEL(e,t);while(o!=null){var u=this.GetNextInAEL(o,t);if(s!=null||t==r.Direction.dLeftToRight&&o.xcurr<=i||t==r.Direction.dRightToLeft&&o.xcurr>=n){if(o.xcurr==e.xtop&&s==null){if(this.SlopesEqual(o,e.nextInLML,this.m_UseFullRange)){e.outIdx>=0&&o.outIdx>=0&&this.AddJoin(e.nextInLML,o,e.outIdx,-1);break}if(o.dx<e.nextInLML.dx)break}if(o==s){t==r.Direction.dLeftToRight?this.IntersectEdges(e,o,new r.IntPoint(o.xcurr,e.ycurr),0):this.IntersectEdges(o,e,new r.IntPoint(o.xcurr,e.ycurr),0);s.outIdx>=0&&r.Error("ProcessHorizontal error");return}o.dx!=r.ClipperBase.horizontal||!!this.IsMinima(o)||o.xcurr>o.xtop?t==r.Direction.dLeftToRight?this.IntersectEdges(e,o,new r.IntPoint(o.xcurr,e.ycurr),this.IsTopHorz(e,o.xcurr)?r.Protects.ipLeft:r.Protects.ipBoth):this.IntersectEdges(o,e,new r.IntPoint(o.xcurr,e.ycurr),this.IsTopHorz(e,o.xcurr)?r.Protects.ipRight:r.Protects.ipBoth):t==r.Direction.dLeftToRight?this.IntersectEdges(e,o,new r.IntPoint(o.xcurr,e.ycurr),this.IsTopHorz(e,o.xcurr)?r.Protects.ipLeft:r.Protects.ipBoth):this.IntersectEdges(o,e,new r.IntPoint(o.xcurr,e.ycurr),this.IsTopHorz(e,o.xcurr)?r.Protects.ipRight:r.Protects.ipBoth);this.SwapPositionsInAEL(e,o)}else if(t==r.Direction.dLeftToRight&&o.xcurr>i&&e.nextInSEL==null||t==r.Direction.dRightToLeft&&o.xcurr<n&&e.nextInSEL==null)break;o=u}if(e.nextInLML!=null){e.outIdx>=0&&this.AddOutPt(e,new r.IntPoint(e.xtop,e.ytop));(function(){e={Value:e};var t=this.UpdateEdgeIntoAEL(e);e=e.Value;return t}).call(this)}else{e.outIdx>=0&&this.IntersectEdges(e,s,new r.IntPoint(e.xtop,e.ycurr),r.Protects.ipBoth);this.DeleteFromAEL(s);this.DeleteFromAEL(e)}};r.Clipper.prototype.IsTopHorz=function(e,t){var n=this.m_SortedEdges;while(n!=null){if(t>=Math.min(n.xcurr,n.xtop)&&t<=Math.max(n.xcurr,n.xtop))return!1;n=n.nextInSEL}return!0};r.Clipper.prototype.GetNextInAEL=function(e,t){return t==r.Direction.dLeftToRight?e.nextInAEL:e.prevInAEL};r.Clipper.prototype.IsMinima=function(e){return e!=null&&e.prev.nextInLML!=e&&e.next.nextInLML!=e};r.Clipper.prototype.IsMaxima=function(e,t){return e!=null&&e.ytop==t&&e.nextInLML==null};r.Clipper.prototype.IsIntermediate=function(e,t){return e.ytop==t&&e.nextInLML!=null};r.Clipper.prototype.GetMaximaPair=function(e){return!this.IsMaxima(e.next,e.ytop)||e.next.xtop!=e.xtop?e.prev:e.next};r.Clipper.prototype.ProcessIntersections=function(e,t){if(this.m_ActiveEdges==null)return!0;try{this.BuildIntersectList(e,t);if(this.m_IntersectNodes==null)return!0;if(!this.FixupIntersections())return!1;this.ProcessIntersectList()}catch(n){this.m_SortedEdges=null;this.DisposeIntersectNodes();r.Error("ProcessIntersections error")}return!0};r.Clipper.prototype.BuildIntersectList=function(e,t){if(this.m_ActiveEdges==null)return;var n=this.m_ActiveEdges;n.tmpX=r.Clipper.TopX(n,t);this.m_SortedEdges=n;this.m_SortedEdges.prevInSEL=null;n=n.nextInAEL;while(n!=null){n.prevInSEL=n.prevInAEL;n.prevInSEL.nextInSEL=n;n.nextInSEL=null;n.tmpX=r.Clipper.TopX(n,t);n=n.nextInAEL}var i=!0;while(i&&this.m_SortedEdges!=null){i=!1;n=this.m_SortedEdges;while(n.nextInSEL!=null){var s=n.nextInSEL,o=new r.IntPoint;if(n.tmpX>s.tmpX&&function(){o={Value:o};var e=this.IntersectPoint(n,s,o);o=o.Value;return e}.call(this)){if(o.Y>e){o.Y=e;o.X=r.Clipper.TopX(n,o.Y)}this.AddIntersectNode(n,s,o);this.SwapPositionsInSEL(n,s);i=!0}else n=s}if(n.prevInSEL==null)break;n.prevInSEL.nextInSEL=null}this.m_SortedEdges=null};r.Clipper.prototype.FixupIntersections=function(){if(this.m_IntersectNodes.next==null)return!0;this.CopyAELToSEL();var e=this.m_IntersectNodes,t=this.m_IntersectNodes.next;while(t!=null){var n=e.edge1,r;if(n.prevInSEL==e.edge2)r=n.prevInSEL;else if(n.nextInSEL==e.edge2)r=n.nextInSEL;else{while(t!=null){if(t.edge1.nextInSEL==t.edge2||t.edge1.prevInSEL==t.edge2)break;t=t.next}if(t==null)return!1;this.SwapIntersectNodes(e,t);n=e.edge1;r=e.edge2}this.SwapPositionsInSEL(n,r);e=e.next;t=e.next}this.m_SortedEdges=null;return e.edge1.prevInSEL==e.edge2||e.edge1.nextInSEL==e.edge2};r.Clipper.prototype.ProcessIntersectList=function(){while(this.m_IntersectNodes!=null){var e=this.m_IntersectNodes.next;this.IntersectEdges(this.m_IntersectNodes.edge1,this.m_IntersectNodes.edge2,this.m_IntersectNodes.pt,r.Protects.ipBoth);this.SwapPositionsInAEL(this.m_IntersectNodes.edge1,this.m_IntersectNodes.edge2);this.m_IntersectNodes=null;this.m_IntersectNodes=e}};var pn=function(e){return e<0?Math.ceil(e-.5):Math.round(e)},dn=function(e){return e<0?Math.ceil(e-.5):Math.floor(e+.5)},vn=function(e){return e<0?-Math.round(Math.abs(e)):Math.round(e)},mn=function(e){if(e<0){e-=.5;return e<-2147483648?Math.ceil(e):e|0}e+=.5;return e>2147483647?Math.floor(e):e|0};n.msie?r.Clipper.Round=pn:n.chromium?r.Clipper.Round=vn:n.safari?r.Clipper.Round=mn:r.Clipper.Round=dn;r.Clipper.TopX=function(e,t){return t==e.ytop?e.xtop:e.xbot+r.Clipper.Round(e.dx*(t-e.ybot))};r.Clipper.prototype.AddIntersectNode=function(e,t,n){var i=new r.IntersectNode;i.edge1=e;i.edge2=t;i.pt=n;i.next=null;if(this.m_IntersectNodes==null)this.m_IntersectNodes=i;else if(this.ProcessParam1BeforeParam2(i,this.m_IntersectNodes)){i.next=this.m_IntersectNodes;this.m_IntersectNodes=i}else{var s=this.m_IntersectNodes;while(s.next!=null&&this.ProcessParam1BeforeParam2(s.next,i))s=s.next;i.next=s.next;s.next=i}};r.Clipper.prototype.ProcessParam1BeforeParam2=function(e,t){var n;if(e.pt.Y==t.pt.Y){if(e.edge1==t.edge1||e.edge2==t.edge1){n=t.pt.X>e.pt.X;return t.edge1.dx>0?!n:n}if(e.edge1==t.edge2||e.edge2==t.edge2){n=t.pt.X>e.pt.X;return t.edge2.dx>0?!n:n}return t.pt.X>e.pt.X}return e.pt.Y>t.pt.Y};r.Clipper.prototype.SwapIntersectNodes=function(e,t){var n=e.edge1,r=e.edge2,i=e.pt;e.edge1=t.edge1;e.edge2=t.edge2;e.pt=t.pt;t.edge1=n;t.edge2=r;t.pt=i};r.Clipper.prototype.IntersectPoint=function(e,t,n){var i,s;if(this.SlopesEqual(e,t,this.m_UseFullRange))return!1;if(e.dx==0){n.Value.X=e.xbot;if(t.dx==r.ClipperBase.horizontal)n.Value.Y=t.ybot;else{s=t.ybot-t.xbot/t.dx;n.Value.Y=r.Clipper.Round(n.Value.X/t.dx+s)}}else if(t.dx==0){n.Value.X=t.xbot;if(e.dx==r.ClipperBase.horizontal)n.Value.Y=e.ybot;else{i=e.ybot-e.xbot/e.dx;n.Value.Y=r.Clipper.Round(n.Value.X/e.dx+i)}}else{i=e.xbot-e.ybot*e.dx;s=t.xbot-t.ybot*t.dx;var o=(s-i)/(e.dx-t.dx);n.Value.Y=r.Clipper.Round(o);r.Math_Abs_Double(e.dx)<r.Math_Abs_Double(t.dx)?n.Value.X=r.Clipper.Round(e.dx*o+i):n.Value.X=r.Clipper.Round(t.dx*o+s)}if(n.Value.Y<e.ytop||n.Value.Y<t.ytop){if(e.ytop>t.ytop){n.Value.X=e.xtop;n.Value.Y=e.ytop;return r.Clipper.TopX(t,e.ytop)<e.xtop}n.Value.X=t.xtop;n.Value.Y=t.ytop;return r.Clipper.TopX(e,t.ytop)>t.xtop}return!0};r.Clipper.prototype.DisposeIntersectNodes=function(){while(this.m_IntersectNodes!=null){var e=this.m_IntersectNodes.next;this.m_IntersectNodes=null;this.m_IntersectNodes=e}};r.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(e){var t=this.m_ActiveEdges,n;while(t!=null)if(this.IsMaxima(t,e)&&this.GetMaximaPair(t).dx!=r.ClipperBase.horizontal){n=t.prevInAEL;this.DoMaxima(t,e);n==null?t=this.m_ActiveEdges:t=n.nextInAEL}else{if(this.IsIntermediate(t,e)&&t.nextInLML.dx==r.ClipperBase.horizontal){if(t.outIdx>=0){this.AddOutPt(t,new r.IntPoint(t.xtop,t.ytop));for(var i=0;i<this.m_HorizJoins.length;++i){var s=new r.IntPoint,o=new r.IntPoint,u=this.m_HorizJoins[i];(function(){s={Value:s};o={Value:o};var e=this.GetOverlapSegment(new r.IntPoint(u.edge.xbot,u.edge.ybot),new r.IntPoint(u.edge.xtop,u.edge.ytop),new r.IntPoint(t.nextInLML.xbot,t.nextInLML.ybot),new r.IntPoint(t.nextInLML.xtop,t.nextInLML.ytop),s,o);s=s.Value;o=o.Value;return e}).call(this)&&this.AddJoin(u.edge,t.nextInLML,u.savedIdx,t.outIdx)}this.AddHorzJoin(t.nextInLML,t.outIdx)}(function(){t={Value:t};var e=this.UpdateEdgeIntoAEL(t);t=t.Value;return e}).call(this);this.AddEdgeToSEL(t)}else{t.xcurr=r.Clipper.TopX(t,e);t.ycurr=e}t=t.nextInAEL}this.ProcessHorizontals();t=this.m_ActiveEdges;while(t!=null){if(this.IsIntermediate(t,e)){t.outIdx>=0&&this.AddOutPt(t,new r.IntPoint(t.xtop,t.ytop));(function(){t={Value:t};var e=this.UpdateEdgeIntoAEL(t);t=t.Value;return e}).call(this);n=t.prevInAEL;var a=t.nextInAEL;if(n!=null&&n.xcurr==t.xbot&&n.ycurr==t.ybot&&t.outIdx>=0&&n.outIdx>=0&&n.ycurr>n.ytop&&this.SlopesEqual(t,n,this.m_UseFullRange)){this.AddOutPt(n,new r.IntPoint(t.xbot,t.ybot));this.AddJoin(t,n,-1,-1)}else if(a!=null&&a.xcurr==t.xbot&&a.ycurr==t.ybot&&t.outIdx>=0&&a.outIdx>=0&&a.ycurr>a.ytop&&this.SlopesEqual(t,a,this.m_UseFullRange)){this.AddOutPt(a,new r.IntPoint(t.xbot,t.ybot));this.AddJoin(t,a,-1,-1)}}t=t.nextInAEL}};r.Clipper.prototype.DoMaxima=function(e,t){var n=this.GetMaximaPair(e),i=e.xtop,s=e.nextInAEL;while(s!=n){s==null&&r.Error("DoMaxima error");this.IntersectEdges(e,s,new r.IntPoint(i,t),r.Protects.ipBoth);s=s.nextInAEL}if(e.outIdx<0&&n.outIdx<0){this.DeleteFromAEL(e);this.DeleteFromAEL(n)}else e.outIdx>=0&&n.outIdx>=0?this.IntersectEdges(e,n,new r.IntPoint(i,t),r.Protects.ipNone):r.Error("DoMaxima error")};r.Clipper.ReversePolygons=function(e){var t=e.length,n;for(var r=0;r<t;r++)e[r]instanceof Array&&e[r].reverse()};r.Clipper.Orientation=function(e){return this.Area(e)>=0};r.Clipper.prototype.PointCount=function(e){if(e==null)return 0;var t=0,n=e;do{t++;n=n.next}while(n!=e);return t};r.Clipper.prototype.BuildResult=function(e){r.Clear(e);var t,n=this.m_PolyOuts.length;for(var i=0;i<n;i++){t=this.m_PolyOuts[i];if(t.pts==null)continue;var s=t.pts,o=this.PointCount(s);if(o<3)continue;var u=new r.Polygon(o);for(var a=0;a<o;a++){u.push(s.pt);s=s.prev}e.push(u)}};r.Clipper.prototype.BuildResultEx=function(e){r.Clear(e);var t=0;while(t<this.m_PolyOuts.length){var n=this.m_PolyOuts[t++];if(n.pts==null)break;var i=n.pts,s=this.PointCount(i);if(s<3)continue;var o=new r.ExPolygon;o.outer=new r.Polygon;o.holes=new r.Polygons;for(var u=0;u<s;u++){o.outer.push(i.pt);i=i.prev}while(t<this.m_PolyOuts.length){n=this.m_PolyOuts
[t];if(n.pts==null||!n.isHole)break;var a=new r.Polygon;i=n.pts;do{a.push(i.pt);i=i.prev}while(i!=n.pts);o.holes.push(a);t++}e.push(o)}};r.Clipper.prototype.FixupOutPolygon=function(e){var t=null;e.pts=e.bottomPt;var n=e.bottomPt;for(;;){if(n.prev==n||n.prev==n.next){this.DisposeOutPts(n);e.pts=null;e.bottomPt=null;return}if(r.ClipperBase.PointsEqual(n.pt,n.next.pt)||this.SlopesEqual(n.prev.pt,n.pt,n.next.pt,this.m_UseFullRange)){t=null;var i=n;n==e.bottomPt&&(e.bottomPt=null);n.prev.next=n.next;n.next.prev=n.prev;n=n.prev;i=null}else{if(n==t)break;t==null&&(t=n);n=n.next}}if(e.bottomPt==null){e.bottomPt=this.GetBottomPt(n);e.bottomPt.idx=e.idx;e.pts=e.bottomPt}};r.Clipper.prototype.JoinPoints=function(e,t,n){t.Value=null;n.Value=null;var i=this.m_PolyOuts[e.poly1Idx],s=this.m_PolyOuts[e.poly2Idx];if(i==null||s==null)return!1;var o=i.pts,u=s.pts,a=e.pt2a,f=e.pt2b,l=e.pt1a,c=e.pt1b;if(!function(){o={Value:o};a={Value:a};f={Value:f};var e=this.FindSegment(o,a,f);o=o.Value;a=a.Value;f=f.Value;return e}.call(this))return!1;if(i==s){u=o.next;if(!function(){u={Value:u};l={Value:l};c={Value:c};var e=this.FindSegment(u,l,c);u=u.Value;l=l.Value;c=c.Value;return e}.call(this)||u==o)return!1}else if(!function(){u={Value:u};l={Value:l};c={Value:c};var e=this.FindSegment(u,l,c);u=u.Value;l=l.Value;c=c.Value;return e}.call(this))return!1;if(!function(){a={Value:a};f={Value:f};var e=this.GetOverlapSegment(a.Value,f.Value,l,c,a,f);a=a.Value;f=f.Value;return e}.call(this))return!1;var h,p,d=o.prev;r.ClipperBase.PointsEqual(o.pt,a)?t.Value=o:r.ClipperBase.PointsEqual(d.pt,a)?t.Value=d:t.Value=this.InsertPolyPtBetween(o,d,a);r.ClipperBase.PointsEqual(o.pt,f)?n.Value=o:r.ClipperBase.PointsEqual(d.pt,f)?n.Value=d:t.Value==o||t.Value==d?n.Value=this.InsertPolyPtBetween(o,d,f):this.Pt3IsBetweenPt1AndPt2(o.pt,t.Value.pt,f)?n.Value=this.InsertPolyPtBetween(o,t.Value,f):n.Value=this.InsertPolyPtBetween(t.Value,d,f);d=u.prev;r.ClipperBase.PointsEqual(u.pt,a)?h=u:r.ClipperBase.PointsEqual(d.pt,a)?h=d:h=this.InsertPolyPtBetween(u,d,a);r.ClipperBase.PointsEqual(u.pt,f)?p=u:r.ClipperBase.PointsEqual(d.pt,f)?p=d:h==u||h==d?p=this.InsertPolyPtBetween(u,d,f):this.Pt3IsBetweenPt1AndPt2(u.pt,h.pt,f)?p=this.InsertPolyPtBetween(u,h,f):p=this.InsertPolyPtBetween(h,d,f);if(t.Value.next==n.Value&&h.prev==p){t.Value.next=h;h.prev=t.Value;n.Value.prev=p;p.next=n.Value;return!0}if(t.Value.prev==n.Value&&h.next==p){t.Value.prev=h;h.next=t.Value;n.Value.next=p;p.prev=n.Value;return!0}return!1};r.Clipper.prototype.FixupJoinRecs=function(e,t,n){for(var r=n;r<this.m_Joins.length;r++){var i=this.m_Joins[r];i.poly1Idx==e.poly1Idx&&this.PointIsVertex(i.pt1a,t)&&(i.poly1Idx=e.poly2Idx);i.poly2Idx==e.poly1Idx&&this.PointIsVertex(i.pt2a,t)&&(i.poly2Idx=e.poly2Idx)}};r.Clipper.prototype.JoinCommonEdges=function(){var e,t;for(var n=0;n<this.m_Joins.length;n++){var r=this.m_Joins[n],i,s;if(!function(){i={Value:i};s={Value:s};var e=this.JoinPoints(r,i,s);i=i.Value;s=s.Value;return e}.call(this))continue;var o=this.m_PolyOuts[r.poly1Idx],u=this.m_PolyOuts[r.poly2Idx];if(o==u){o.pts=this.GetBottomPt(i);o.bottomPt=o.pts;o.bottomPt.idx=o.idx;u=this.CreateOutRec();this.m_PolyOuts.push(u);u.idx=this.m_PolyOuts.length-1;r.poly2Idx=u.idx;u.pts=this.GetBottomPt(s);u.bottomPt=u.pts;u.bottomPt.idx=u.idx;if(this.PointInPolygon(u.pts.pt,o.pts,this.m_UseFullRange)){u.isHole=!o.isHole;u.FirstLeft=o;this.FixupJoinRecs(r,s,n+1);this.FixupOutPolygon(o);this.FixupOutPolygon(u);(u.isHole^this.m_ReverseOutput)==this.Area(u,this.m_UseFullRange)>0&&this.ReversePolyPtLinks(u.pts)}else if(this.PointInPolygon(o.pts.pt,u.pts,this.m_UseFullRange)){u.isHole=o.isHole;o.isHole=!u.isHole;u.FirstLeft=o.FirstLeft;o.FirstLeft=u;this.FixupJoinRecs(r,s,n+1);this.FixupOutPolygon(o);this.FixupOutPolygon(u);(o.isHole^this.m_ReverseOutput)==this.Area(o,this.m_UseFullRange)>0&&this.ReversePolyPtLinks(o.pts);if(this.m_UsingExPolygons&&o.isHole)for(e=0;e<this.m_PolyOuts.length;++e){t=this.m_PolyOuts[e];t.isHole&&t.bottomPt!=null&&t.FirstLeft==o&&(t.FirstLeft=u)}}else{u.isHole=o.isHole;u.FirstLeft=o.FirstLeft;this.FixupJoinRecs(r,s,n+1);this.FixupOutPolygon(o);this.FixupOutPolygon(u);if(this.m_UsingExPolygons&&u.pts!=null)for(e=0;e<this.m_PolyOuts.length;++e){t=this.m_PolyOuts[e];t.isHole&&t.bottomPt!=null&&t.FirstLeft==o&&this.PointInPolygon(t.bottomPt.pt,u.pts,this.m_UseFullRange)&&(t.FirstLeft=u)}}}else{if(this.m_UsingExPolygons)for(e=0;e<this.m_PolyOuts.length;++e)this.m_PolyOuts[e].isHole&&this.m_PolyOuts[e].bottomPt!=null&&this.m_PolyOuts[e].FirstLeft==u&&(this.m_PolyOuts[e].FirstLeft=o);this.FixupOutPolygon(o);if(o.pts!=null){o.isHole=this.Area(o,this.m_UseFullRange)<0;o.isHole&&o.FirstLeft==null&&(o.FirstLeft=u.FirstLeft)}var a=o.idx,f=u.idx;u.pts=null;u.bottomPt=null;u.AppendLink=o;for(e=n+1;e<this.m_Joins.length;e++){var l=this.m_Joins[e];l.poly1Idx==f&&(l.poly1Idx=a);l.poly2Idx==f&&(l.poly2Idx=a)}}}};r.Clipper.FullRangeNeeded=function(e){var t=!1;for(var n=0;n<e.length;n++)if(r.Math_Abs_Int64(e[n].X)>r.ClipperBase.hiRange||r.Math_Abs_Int64(e[n].Y)>r.ClipperBase.hiRange)r.Error("Coordinate exceeds range bounds in FullRangeNeeded().");else if(r.Math_Abs_Int64(e[n].X)>r.ClipperBase.loRange||r.Math_Abs_Int64(e[n].Y)>r.ClipperBase.loRange)t=!0;return t};r.Clipper.prototype.Area=r.Clipper.Area=function(){var e=arguments,t,n;if(e.length==1){var i=e[0],s=i.length-1;if(s<2)return 0;if(r.Clipper.FullRangeNeeded(i)){n=(new u(i[s].X+i[0].X)).multiply(new u(i[0].Y-i[s].Y));for(t=1;t<=s;++t)n=n.add((new u(i[t-1].X+i[t].X)).multiply(new u(i[t].Y-i[t-1].Y)));return parseFloat(n.toString())/2}var o=(i[s].X+i[0].X)*(i[0].Y-i[s].Y);for(t=1;t<=s;++t)o+=(i[t-1].X+i[t].X)*(i[t].Y-i[t-1].Y);return o/2}if(e.length==2){var a=e[0],f=e[1],l=a.pts;if(l==null)return 0;if(f){n=new u(u.ZERO);do{n=n.add((new u(l.pt.X+l.prev.pt.X)).multiply(new u(l.prev.pt.Y-l.pt.Y)));l=l.next}while(l!=a.pts);return parseFloat(n.toString())/2}n=0;do{n+=(l.pt.X+l.prev.pt.X)*(l.prev.pt.Y-l.pt.Y);l=l.next}while(l!=a.pts);return n/2}};r.Clipper.BuildArc=function(e,t,n,i){var s=Math.sqrt(r.Math_Abs_Double(i))*r.Math_Abs_Double(n-t);s/=4;s<6&&(s=6);s>64&&(s=r.MaxSteps);var o=r.Cast_Int32(s),u=new r.Polygon,a=(n-t)/(o-1),f=t;for(var l=0;l<o;++l){u.push(new r.IntPoint(e.X+r.Clipper.Round(Math.cos(f)*i),e.Y+r.Clipper.Round(Math.sin(f)*i)));f+=a}return u};r.Clipper.GetUnitNormal=function(e,t){var n=t.X-e.X,i=t.Y-e.Y;if(n==0&&i==0)return new r.Clipper.DoublePoint(0,0);var s=1/Math.sqrt(n*n+i*i);n*=s;i*=s;return new r.Clipper.DoublePoint(i,-n)};r.Clipper.prototype.OffsetPolygons=function(e,t,n,i,s){var o=arguments;if(o.length==4)s=!0;else if(o.length==3){i=2;s=!0}else if(o.length==2){n=r.JoinType.jtSquare;i=2;s=!0}isNaN(t)?r.Error("Delta is not a number"):isNaN(i)&&r.Error("MiterLimit is not a number");var u={};new r.Clipper.PolyOffsetBuilder(e,u,t,n,i,s);u.Value?u=u.Value:u=[[]];return u};r.Clipper.prototype.SimplifyPolygon=function(e,t){var n=new r.Polygons,i=new r.Clipper;i.AddPolygon(e,r.PolyType.ptSubject)&&i.Execute(r.ClipType.ctUnion,n,t,t);return n};r.Clipper.prototype.SimplifyPolygons=function(e,t){var n=new r.Polygons,i=new r.Clipper;i.AddPolygons(e,r.PolyType.ptSubject)&&i.Execute(r.ClipType.ctUnion,n,t,t);return n};var gn=r.Clipper,yn=r.ClipperBase,bn;if(typeof Object.getOwnPropertyNames=="undefined"){for(bn in yn.prototype)if(typeof gn.prototype[bn]=="undefined"||gn.prototype[bn]==Object.prototype[bn])gn.prototype[bn]=yn.prototype[bn];for(bn in yn)typeof gn[bn]=="undefined"&&(gn[bn]=yn[bn]);gn.$baseCtor=yn}else{var wn=Object.getOwnPropertyNames(yn.prototype);for(var En=0;En<wn.length;En++)typeof Object.getOwnPropertyDescriptor(gn.prototype,wn[En])=="undefined"&&Object.defineProperty(gn.prototype,wn[En],Object.getOwnPropertyDescriptor(yn.prototype,wn[En]));for(bn in yn)typeof gn[bn]=="undefined"&&(gn[bn]=yn[bn]);gn.$baseCtor=yn}r.Clipper.DoublePoint=function(e,t){this.X=e;this.Y=t};r.Clipper.PolyOffsetBuilder=function(e,t,n,i,s,o){this.pts=null;this.currentPoly=null;this.normals=null;this.delta=0;this.m_R=0;this.m_i=0;this.m_j=0;this.m_k=0;this.botPt=null;if(n==0){t.Value=e;return}this.pts=e;this.delta=n;var u,a;if(o){var f=this.pts.length,l=0;while(l<f&&this.pts[l].length==0)l++;if(l==f)return;this.botPt=this.pts[l][0];for(u=l;u<f;++u){this.UpdateBotPt(this.pts[u][0])&&(l=u);for(a=this.pts[u].length-1;a>0;a--)r.ClipperBase.PointsEqual(this.pts[u][a],this.pts[u][a-1])?this.pts[u].splice(a,1):this.UpdateBotPt(this.pts[u][a])&&(l=u)}r.Clipper.Orientation(this.pts[l])||r.Clipper.ReversePolygons(this.pts)}s<=1&&(s=1);var c=2/(s*s);this.normals=[];var h=n*n;t.Value=new r.Polygons;r.Clear(t.Value);var p;for(this.m_i=0;this.m_i<this.pts.length;this.m_i++){p=this.pts[this.m_i].length;p>1&&this.pts[this.m_i][0].X==this.pts[this.m_i][p-1].X&&this.pts[this.m_i][0].Y==this.pts[this.m_i][p-1].Y&&p--;if(p==0||p<3&&n<=0)continue;if(p==1){var d;d=r.Clipper.BuildArc(this.pts[this.m_i][p-1],0,r.PI2,n);t.Value.push(d);continue}r.Clear(this.normals);for(a=0;a<p-1;++a)this.normals.push(r.Clipper.GetUnitNormal(this.pts[this.m_i][a],this.pts[this.m_i][a+1]));this.normals.push(r.Clipper.GetUnitNormal(this.pts[this.m_i][p-1],this.pts[this.m_i][0]));this.currentPoly=new r.Polygon;this.m_k=p-1;for(this.m_j=0;this.m_j<p;++this.m_j){switch(i){case r.JoinType.jtMiter:this.m_R=1+(this.normals[this.m_j].X*this.normals[this.m_k].X+this.normals[this.m_j].Y*this.normals[this.m_k].Y);this.m_R>=c?this.DoMiter():this.DoSquare(s);break;case r.JoinType.jtRound:this.DoRound();break;case r.JoinType.jtSquare:this.DoSquare(1)}this.m_k=this.m_j}t.Value.push(this.currentPoly)}var v=new r.Clipper;v.AddPolygons(t.Value,r.PolyType.ptSubject);if(n>0)v.Execute(r.ClipType.ctUnion,t.Value,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else{var m=v.GetBounds(),g=new r.Polygon;g.push(new r.IntPoint(m.left-10,m.bottom+10));g.push(new r.IntPoint(m.right+10,m.bottom+10));g.push(new r.IntPoint(m.right+10,m.top-10));g.push(new r.IntPoint(m.left-10,m.top-10));v.AddPolygon(g,r.PolyType.ptSubject);v.Execute(r.ClipType.ctUnion,t.Value,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative);if(t.Value.length>0){t.Value.splice(0,1);for(u=0;u<t.Value.length;u++)t.Value[u].reverse()}}};r.Clipper.PolyOffsetBuilder.prototype.UpdateBotPt=function(e){if(e.Y>this.botPt.Y||e.Y==this.botPt.Y&&e.X<this.botPt.X){this.botPt=e;return!0}return!1};r.Clipper.PolyOffsetBuilder.prototype.AddPoint=function(e){this.currentPoly.push(e)};r.Clipper.PolyOffsetBuilder.prototype.DoSquare=function(e){var t=new r.IntPoint(r.Cast_Int64(r.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_k].X*this.delta)),r.Cast_Int64(r.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_k].Y*this.delta))),n=new r.IntPoint(r.Cast_Int64(r.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_j].X*this.delta)),r.Cast_Int64(r.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_j].Y*this.delta)));if((this.normals[this.m_k].X*this.normals[this.m_j].Y-this.normals[this.m_j].X*this.normals[this.m_k].Y)*this.delta>=0){var i=Math.atan2(this.normals[this.m_k].Y,this.normals[this.m_k].X),s=Math.atan2(-this.normals[this.m_j].Y,-this.normals[this.m_j].X);i=Math.abs(s-i);i>r.PI&&(i=r.PI2-i);var o=Math.tan((r.PI-i)/4)*Math.abs(this.delta*e);t=new r.IntPoint(r.Cast_Int64(t.X-this.normals[this.m_k].Y*o),r.Cast_Int64(t.Y+this.normals[this.m_k].X*o));this.AddPoint(t);n=new r.IntPoint(r.Cast_Int64(n.X+this.normals[this.m_j].Y*o),r.Cast_Int64(n.Y-this.normals[this.m_j].X*o));this.AddPoint(n)}else{this.AddPoint(t);this.AddPoint(this.pts[this.m_i][this.m_j]);this.AddPoint(n)}};r.Clipper.PolyOffsetBuilder.prototype.DoMiter=function(){if((this.normals[this.m_k].X*this.normals[this.m_j].Y-this.normals[this.m_j].X*this.normals[this.m_k].Y)*this.delta>=0){var e=this.delta/this.m_R;this.AddPoint(new r.IntPoint(r.Cast_Int64(r.Clipper.Round(this.pts[this.m_i][this.m_j].X+(this.normals[this.m_k].X+this.normals[this.m_j].X)*e)),r.Cast_Int64(r.Clipper.Round(this.pts[this.m_i][this.m_j].Y+(this.normals[this.m_k].Y+this.normals[this.m_j].Y)*e))))}else{var t=new r.IntPoint(r.Cast_Int64(r.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_k].X*this.delta)),r.Cast_Int64(r.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_k].Y*this.delta))),n=new r.IntPoint(r.Cast_Int64(r.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_j].X*this.delta)),r.Cast_Int64(r.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_j].Y*this.delta)));this.AddPoint(t);this.AddPoint(this.pts[this.m_i][this.m_j]);this.AddPoint(n)}};r.Clipper.PolyOffsetBuilder.prototype.DoRound=function(){var e=new r.IntPoint(r.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_k].X*this.delta),r.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_k].Y*this.delta)),t=new r.IntPoint(r.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_j].X*this.delta),r.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_j].Y*this.delta));this.AddPoint(e);if((this.normals[this.m_k].X*this.normals[this.m_j].Y-this.normals[this.m_j].X*this.normals[this.m_k].Y)*this.delta>=0){if(this.normals[this.m_j].X*this.normals[this.m_k].X+this.normals[this.m_j].Y*this.normals[this.m_k].Y<.985){var n=Math.atan2(this.normals[this.m_k].Y,this.normals[this.m_k].X),i=Math.atan2(this.normals[this.m_j].Y,this.normals[this.m_j].X);this.delta>0&&i<n?i+=r.PI2:this.delta<0&&i>n&&(i-=r.PI2);var s=r.Clipper.BuildArc(this.pts[this.m_i][this.m_j],n,i,this.delta);for(var o=0;o<s.length;o++)this.AddPoint(s[o])}}else this.AddPoint(this.pts[this.m_i][this.m_j]);this.AddPoint(t)};r.Error=function(e){try{throw new Error(e)}catch(t){alert(t.message)}};r.Clone=function(e){if(e instanceof Array){if(e.length==0)return[];if(e.length==1&&e[0].length==0)return[[]];var t=e[0]instanceof Array;t||(e=[e]);var n=e.length,r,i,s,o,u=[];for(i=0;i<n;i++){r=e[i].length;o=[];for(s=0;s<r;s++)o.push({X:e[i][s].X,Y:e[i][s].Y});u.push(o)}t||(u=u[0]);return u}return[]};r.Clean=function(e,t){if(e instanceof Array){var n=e[0]instanceof Array,e=r.Clone(e);if(typeof t!="number"||t===null){r.Error("Delta is not a number in Clean().");return e}if(e.length==0||e.length==1&&e[0].length==0||t<0)return e;n||(e=[e]);var i=e.length,s,o,u,a,f,l,c,h=[];for(var p=0;p<i;p++){o=e[p];s=o.length;if(s==0)continue;if(s<3){u=o;h.push(u);continue}u=o;a=t*t;f=o[0];l=1;for(c=1;c<s;c++){if((o[c].X-f.X)*(o[c].X-f.X)+(o[c].Y-f.Y)*(o[c].Y-f.Y)<=a)continue;u[l]=o[c];f=o[c];l++}f=o[l-1];(o[0].X-f.X)*(o[0].X-f.X)+(o[0].Y-f.Y)*(o[0].Y-f.Y)<=a&&l--;l<s&&u.splice(l,s-l);u.length&&h.push(u)}!n&&h.length?h=h[0]:!n&&h.length==0?h=[]:n&&h.length==0&&(h=[[]]);return h}return[]};r.Lighten=function(e,t){if(e instanceof Array){if(typeof t!="number"||t===null){r.Error("Tolerance is not a number in Lighten().");return r.Clone(e)}if(e.length===0||e.length==1&&e[0].length===0||t<0)return r.Clone(e);e[0]instanceof Array||(e=[e]);var n,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y=e.length,b=[];for(n=0;n<y;n++){s=e[n];for(o=0;o<1e6;o++){u=[];a=s.length;if(s[a-1].X!=s[0].X||s[a-1].Y!=s[0].Y){d=1;s.push({X:s[0].X,Y:s[0].Y});a=s.length}else d=0;p=[];for(i=0;i<a-2;i++){f=s[i];c=s[i+1];l=s[i+2];v=l.X-f.X;m=l.Y-f.Y;h=0;if(v!==0||m!==0){g=Math.sqrt(v*v+m*m);h=Math.abs((c.X-f.X)*m-(c.Y-f.Y)*v)/g}if(h<=t){p[i+1]=1;i++}}u.push({X:s[0].X,Y:s[0].Y});for(i=1;i<a-1;i++)p[i]||u.push({X:s[i].X,Y:s[i].Y});u.push({X:s[a-1].X,Y:s[a-1].Y});d&&s.pop();if(!p.length)break;s=u}a=u.length;u[a-1].X==u[0].X&&u[a-1].Y==u[0].Y&&u.pop();u.length>2&&b.push(u)}!e[0]instanceof Array&&(b=b[0]);typeof b=="undefined"&&(b=[[]]);return b}return[]};e.ClipperLib=r})(window);